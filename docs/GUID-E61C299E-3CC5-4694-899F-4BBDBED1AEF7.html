<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us" data-whc_version="24.1">
    <head><link rel="shortcut icon" href="oxygen-webhelp\template\resources/images/favicon.ico"/><link rel="icon" href="oxygen-webhelp\template\resources/images/favicon.ico"/><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="description" content="Zigbee Device Profile (ZDP) requests offer a set of functionality to manage the network, discover devices and services, and more. The ZDO_ZdpReq() function sends out a ZDP request. The reqCluster ..."/><meta name="copyright" content="(C) Copyright 2024"/><meta name="generator" content="DITA-OT"/><title>4.6.3 Sending ZDP Requests</title><!--  Generated with Oxygen version 24.1, build number 2022062014.  --><meta name="wh-path2root" content=""/><meta name="wh-toc-id" content="GUID-E61C299E-3CC5-4694-899F-4BBDBED1AEF7-d2425e365"/><meta name="wh-source-relpath" content="GUID-E61C299E-3CC5-4694-899F-4BBDBED1AEF7.xml"/><meta name="wh-out-relpath" content="GUID-E61C299E-3CC5-4694-899F-4BBDBED1AEF7.html"/>
    <!-- Latest compiled and minified Bootstrap CSS -->
    <link rel="stylesheet" type="text/css" href="./oxygen-webhelp/lib/bootstrap/css/bootstrap.min.css"/>
    
    <link rel="stylesheet" href="./oxygen-webhelp/lib/jquery-ui/jquery-ui.min.css"/>
    
    <!-- Template default styles  -->
    <link rel="stylesheet" type="text/css" href="./oxygen-webhelp/app/topic-page.css?buildId=2022062014"/>
    
    
    <script src="./oxygen-webhelp/lib/jquery/jquery-3.5.1.min.js"></script>
    
    <script data-main="./oxygen-webhelp/app/topic-page.js" src="./oxygen-webhelp/lib/requirejs/require.js"></script>
<link rel="stylesheet" type="text/css" href="oxygen-webhelp/template/microchip.css?buildId=2022062014"/><link rel="stylesheet" type="text/css" href="oxygen-webhelp/template/notes.css?buildId=2022062014"/>
<script src="mchp-context-help.js"></script>
<link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,300" rel="stylesheet" type="text/css"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async="" type="text/javascript"></script>
    <script src="https://assets.adobedtm.com/6a72a357eb48/a636c708c7fe/launch-0b0023397020.min.js"></script><!-- Adobe Analytics -->
</head>

    <body id="GUID-E61C299E-3CC5-4694-899F-4BBDBED1AEF7" class="wh_topic_page frmBody">
        <a href="#wh_topic_body" class="sr-only sr-only-focusable">
            Jump to main content
        </a>
        
        
        
        
        <header class="navbar navbar-default wh_header">
    <div class="container-fluid">
        <div class="wh_header_flex_container navbar-nav navbar-expand-md navbar-dark">
            <div class="wh_logo_and_publication_title_container">
                <div class="wh_logo_and_publication_title">
                    
                    <a href="index.html" class=" wh_logo d-none d-sm-block "><img src="oxygen-webhelp\template\resources/images/microchip.png" alt="MPLAB® Harmony Wireless Zigbee &#xA;    "/></a>
                    <div class=" wh_publication_title "><a href="index.html">MPLAB® Harmony Wireless Zigbee 
    </a></div>
                    
                </div>
                
                
            </div>

            <div class="wh_top_menu_and_indexterms_link collapse navbar-collapse" id="wh_top_menu_and_indexterms_link">
                
                
                
                
            </div>
        </div>
    </div>
</header>
        
        
         
        
        <div class=" wh_search_input navbar-form wh_topic_page_search search " role="form">
            
            
            
            <form id="searchForm" method="get" role="search" action="search.html"><div class="d-flex justify-contents-around"><div class="flex-grow-1"></div><div class="position-relative flex-grow-1"><input type="search" placeholder="Search " class="wh_search_textfield" id="textToSearch" name="searchQuery" aria-label="Search query" required="required"/><button type="submit" class="wh_search_button" aria-label="Search"><span class="search_input_text">Search</span></button></div><div class="align-self-center flex-grow-1 ml-2"></div></div></form>
            
            <div class="mchp-color-stripe-grid-container">
  <div class="mchp-main-bar mchp-orange-bar"></div>
  <div class="mchp-main-bar mchp-blue-bar"></div>
  <div class="mchp-main-bar mchp-green-bar"></div>
</div>
            
        </div>
        
        <div class="container-fluid" id="wh_topic_container">
            <div class="row">

                <nav class="wh_tools d-print-none navbar-expand-md" aria-label="Tools">
                    
                    <div data-tooltip-position="bottom" class=" wh_breadcrumb "><ol class="d-print-none"><li><span class="home"><a href="index.html"><span>Home</span></a></span></li><li><div class="topicref" data-id="GUID-1599DD35-8680-4FD4-867D-938D77A52B57"><div class="title"><a href="GUID-1599DD35-8680-4FD4-867D-938D77A52B57.html"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">4</ph>
Zigbee Stack Layer Usage</a></div></div></li><li><div class="topicref" data-id="GUID-72AB5A6D-8A28-4640-A202-8B23B24F01F3"><div class="title"><a href="GUID-72AB5A6D-8A28-4640-A202-8B23B24F01F3.html"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">4.6</ph>
Zigbee Device Objects (ZDO) Component Usage</a></div></div></li><li class="active"><div class="topicref" data-id="GUID-E61C299E-3CC5-4694-899F-4BBDBED1AEF7"><div class="title"><a href="GUID-E61C299E-3CC5-4694-899F-4BBDBED1AEF7.html"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">4.6.3</ph>
Sending ZDP Requests</a></div></div></li></ol></div>
                    
                    
                    
                    <div class="wh_right_tools">
                        <button class="wh_hide_highlight" aria-label="Toggle search highlights" title="Toggle search highlights"></button>
                        <button class="webhelp_expand_collapse_sections" data-next-state="collapsed" aria-label="Collapse sections" title="Collapse sections"></button>
                        
                        
                        
                        
                        <div class=" wh_print_link print d-none d-md-inline-block "><button onClick="window.print()" title="Print this page" aria-label="Print this page"></button></div>
                        
                        <button type="button" id="wh_toc_button" class="custom-toggler navbar-toggler collapsed wh_toggle_button navbar-light" aria-expanded="false" aria-label="Toggle publishing table of content" aria-controls="wh_publication_toc">
                            <span class="navbar-toggler-icon"></span>
                        </button>
                    </div>
                    
                </nav>
            </div>
            
            <div class="row" style="margin-top: -1em;"><div class="col-lg-7 col-md-7 col-sm-12 offset-lg-3 offset-md-3 text-right border-bottom mb-1"><h2 class="text-dark header_title">
    </h2></div></div>
            
            
            <div class="wh_content_area">
                <div class="row">
                    
                        <nav id="wh_publication_toc" class="col-lg-3 col-md-3 col-sm-12 d-md-block d-none d-print-none" aria-label="Table of Contents Container">
                            <div id="wh_publication_toc_content">
		                        
                            	<div class=" wh_publication_toc " data-tooltip-position="right"><span class="expand-button-action-labels"><span id="button-expand-action" role="button" aria-label="Expand"></span><span id="button-collapse-action" role="button" aria-label="Collapse"></span><span id="button-pending-action" role="button" aria-label="Pending"></span></span><ul role="tree" aria-label="Table of Contents"><li role="treeitem"><div data-tocid="GUID-221B4CC9-4C60-4770-BBD4-843543C6F801-d2425e11" class="topicref introduction" data-id="GUID-221B4CC9-4C60-4770-BBD4-843543C6F801" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="GUID-221B4CC9-4C60-4770-BBD4-843543C6F801.html" id="GUID-221B4CC9-4C60-4770-BBD4-843543C6F801-d2425e11-link">Introduction</a></div></div></li><li role="treeitem"><div data-tocid="GUID-1FD22A1C-E685-4C71-A9E5-B9A5505E9207-d2425e19" class="topicref introduction" data-id="GUID-1FD22A1C-E685-4C71-A9E5-B9A5505E9207" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="GUID-1FD22A1C-E685-4C71-A9E5-B9A5505E9207.html" id="GUID-1FD22A1C-E685-4C71-A9E5-B9A5505E9207-d2425e19-link">Features</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-4BC995C4-3896-485C-BACF-9BE6865BBBC5-d2425e27" class="topicref" data-id="GUID-4BC995C4-3896-485C-BACF-9BE6865BBBC5" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-4BC995C4-3896-485C-BACF-9BE6865BBBC5-d2425e27-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-4BC995C4-3896-485C-BACF-9BE6865BBBC5.html" id="GUID-4BC995C4-3896-485C-BACF-9BE6865BBBC5-d2425e27-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">1</ph>
Quick References</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-CC00474A-018F-4772-8C7F-5C64FA7F7E38-d2425e51" class="topicref" data-id="GUID-CC00474A-018F-4772-8C7F-5C64FA7F7E38" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-CC00474A-018F-4772-8C7F-5C64FA7F7E38-d2425e51-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-CC00474A-018F-4772-8C7F-5C64FA7F7E38.html" id="GUID-CC00474A-018F-4772-8C7F-5C64FA7F7E38-d2425e51-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">2</ph>
BitCloud Zigbee Stack Architecture and API Overview</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-3FD09F76-6492-4AA5-8F98-0995FEAD2686-d2425e84" class="topicref" data-id="GUID-3FD09F76-6492-4AA5-8F98-0995FEAD2686" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-3FD09F76-6492-4AA5-8F98-0995FEAD2686-d2425e84-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-3FD09F76-6492-4AA5-8F98-0995FEAD2686.html" id="GUID-3FD09F76-6492-4AA5-8F98-0995FEAD2686-d2425e84-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">3</ph>
Programming Basics</a></div></div></li><li role="treeitem" aria-expanded="true"><div data-tocid="GUID-1599DD35-8680-4FD4-867D-938D77A52B57-d2425e141" class="topicref" data-id="GUID-1599DD35-8680-4FD4-867D-938D77A52B57" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action GUID-1599DD35-8680-4FD4-867D-938D77A52B57-d2425e141-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-1599DD35-8680-4FD4-867D-938D77A52B57.html" id="GUID-1599DD35-8680-4FD4-867D-938D77A52B57-d2425e141-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">4</ph>
Zigbee Stack Layer Usage</a></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-FC956B9D-553C-4CEF-B7C2-73CCE741705B-d2425e149" class="topicref" data-id="GUID-FC956B9D-553C-4CEF-B7C2-73CCE741705B" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-FC956B9D-553C-4CEF-B7C2-73CCE741705B-d2425e149-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-FC956B9D-553C-4CEF-B7C2-73CCE741705B.html" id="GUID-FC956B9D-553C-4CEF-B7C2-73CCE741705B-d2425e149-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">4.1</ph>
BDB Component Usage</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-C306947F-F175-4699-B119-75961F5CDE21-d2425e197" class="topicref" data-id="GUID-C306947F-F175-4699-B119-75961F5CDE21" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-C306947F-F175-4699-B119-75961F5CDE21-d2425e197-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-C306947F-F175-4699-B119-75961F5CDE21.html" id="GUID-C306947F-F175-4699-B119-75961F5CDE21-d2425e197-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">4.2</ph>
Configuration Server Component Usage</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-39CF18F8-E921-45B0-BA0B-B39CCD326B44-d2425e253" class="topicref" data-id="GUID-39CF18F8-E921-45B0-BA0B-B39CCD326B44" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-39CF18F8-E921-45B0-BA0B-B39CCD326B44-d2425e253-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-39CF18F8-E921-45B0-BA0B-B39CCD326B44.html" id="GUID-39CF18F8-E921-45B0-BA0B-B39CCD326B44-d2425e253-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">4.3</ph>
HAL Component Usage</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-9EA8133D-53DD-415E-8E08-CBC0969FFCA5-d2425e277" class="topicref" data-id="GUID-9EA8133D-53DD-415E-8E08-CBC0969FFCA5" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-9EA8133D-53DD-415E-8E08-CBC0969FFCA5-d2425e277-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-9EA8133D-53DD-415E-8E08-CBC0969FFCA5.html" id="GUID-9EA8133D-53DD-415E-8E08-CBC0969FFCA5-d2425e277-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">4.4</ph>
System Environment Components Usage</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-0685D527-995B-4A5C-AFB9-036CF801ADCF-d2425e301" class="topicref" data-id="GUID-0685D527-995B-4A5C-AFB9-036CF801ADCF" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-0685D527-995B-4A5C-AFB9-036CF801ADCF-d2425e301-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-0685D527-995B-4A5C-AFB9-036CF801ADCF.html" id="GUID-0685D527-995B-4A5C-AFB9-036CF801ADCF-d2425e301-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">4.5</ph>
Zigbee Cluster Library (ZCL) Components Usage</a></div></div></li><li role="treeitem" aria-expanded="true"><div data-tocid="GUID-72AB5A6D-8A28-4640-A202-8B23B24F01F3-d2425e341" class="topicref" data-id="GUID-72AB5A6D-8A28-4640-A202-8B23B24F01F3" data-state="expanded"><span role="button" tabindex="0" aria-labelledby="button-collapse-action GUID-72AB5A6D-8A28-4640-A202-8B23B24F01F3-d2425e341-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-72AB5A6D-8A28-4640-A202-8B23B24F01F3.html" id="GUID-72AB5A6D-8A28-4640-A202-8B23B24F01F3-d2425e341-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">4.6</ph>
Zigbee Device Objects (ZDO) Component Usage</a></div></div><ul role="group" class="navbar-nav nav-list"><li role="treeitem"><div data-tocid="GUID-7DA11783-3823-4A61-BE28-6A83F87EB2DC-d2425e349" class="topicref" data-id="GUID-7DA11783-3823-4A61-BE28-6A83F87EB2DC" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="GUID-7DA11783-3823-4A61-BE28-6A83F87EB2DC.html" id="GUID-7DA11783-3823-4A61-BE28-6A83F87EB2DC-d2425e349-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">4.6.1</ph>
Network Start</a></div></div></li><li role="treeitem"><div data-tocid="GUID-D1C161BD-B851-41F5-9523-4A4BCB3E09B0-d2425e357" class="topicref" data-id="GUID-D1C161BD-B851-41F5-9523-4A4BCB3E09B0" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="GUID-D1C161BD-B851-41F5-9523-4A4BCB3E09B0.html" id="GUID-D1C161BD-B851-41F5-9523-4A4BCB3E09B0-d2425e357-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">4.6.2</ph>
Handling Network Notifications</a></div></div></li><li role="treeitem" class="active"><div data-tocid="GUID-E61C299E-3CC5-4694-899F-4BBDBED1AEF7-d2425e365" class="topicref" data-id="GUID-E61C299E-3CC5-4694-899F-4BBDBED1AEF7" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="GUID-E61C299E-3CC5-4694-899F-4BBDBED1AEF7.html" id="GUID-E61C299E-3CC5-4694-899F-4BBDBED1AEF7-d2425e365-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">4.6.3</ph>
Sending ZDP Requests</a></div></div></li></ul></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-B10D2E54-2455-4C1C-ACA0-3F48DFA9033C-d2425e373" class="topicref" data-id="GUID-B10D2E54-2455-4C1C-ACA0-3F48DFA9033C" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-B10D2E54-2455-4C1C-ACA0-3F48DFA9033C-d2425e373-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-B10D2E54-2455-4C1C-ACA0-3F48DFA9033C.html" id="GUID-B10D2E54-2455-4C1C-ACA0-3F48DFA9033C-d2425e373-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">4.7</ph>
Zigbee Green Power (ZGP) Component Usage</a></div></div></li></ul></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-397BF2A8-C30D-41CD-AF5A-48074AB7E108-d2425e391" class="topicref" data-id="GUID-397BF2A8-C30D-41CD-AF5A-48074AB7E108" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-397BF2A8-C30D-41CD-AF5A-48074AB7E108-d2425e391-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-397BF2A8-C30D-41CD-AF5A-48074AB7E108.html" id="GUID-397BF2A8-C30D-41CD-AF5A-48074AB7E108-d2425e391-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">5</ph>
References</a></div></div></li><li role="treeitem"><div data-tocid="GUID-CC779138-9BBE-42F3-B4B6-6436C75291E6-d2425e2685" class="topicref" data-id="GUID-CC779138-9BBE-42F3-B4B6-6436C75291E6" data-state="leaf"><span role="button" class="wh-expand-btn"></span><div class="title"><a href="GUID-CC779138-9BBE-42F3-B4B6-6436C75291E6.html" id="GUID-CC779138-9BBE-42F3-B4B6-6436C75291E6-d2425e2685-link"><ph xmlns="http://www.oxygenxml.com/ns/webhelp/toc">6</ph>
Document Revision History</a></div></div></li><li role="treeitem" aria-expanded="false"><div data-tocid="GUID-0FB3F908-88EE-45CE-94F5-E97AF9049C9B-d2425e2693" class="topicref backmatter backmatter_parent" data-id="GUID-0FB3F908-88EE-45CE-94F5-E97AF9049C9B" data-state="not-ready"><span role="button" tabindex="0" aria-labelledby="button-expand-action GUID-0FB3F908-88EE-45CE-94F5-E97AF9049C9B-d2425e2693-link" class="wh-expand-btn"></span><div class="title"><a href="GUID-0FB3F908-88EE-45CE-94F5-E97AF9049C9B.html" id="GUID-0FB3F908-88EE-45CE-94F5-E97AF9049C9B-d2425e2693-link">Microchip Information</a></div></div></li></ul></div>
		                        
                            </div>
                        </nav>
                    
                    
                    <div class="col-lg-7 col-md-9 col-sm-12" id="wh_topic_body">
                        <button id="wh_close_publication_toc_button" class="close-toc-button d-none" aria-label="Toggle publishing table of content" aria-controls="wh_publication_toc" aria-expanded="true">
                            <span class="close-toc-icon-container">
                                <span class="close-toc-icon"></span>     
                            </span>
                        </button>
                        <button id="wh_close_topic_toc_button" class="close-toc-button d-none" aria-label="Toggle topic table of content" aria-controls="wh_topic_toc" aria-expanded="true">
                            <span class="close-toc-icon-container">
                                <span class="close-toc-icon"></span>     
                            </span>
                        </button>
                        
                        <div class=" wh_topic_content body "><main role="main"><article role="article" aria-labelledby="GUID-E61C299E-3CC5-4694-899F-4BBDBED1AEF7__GUID-80379D68-D07F-4398-90C4-5AFCD42B5FEE"><h1 class="- topic/title title topictitle1" id="GUID-E61C299E-3CC5-4694-899F-4BBDBED1AEF7__GUID-80379D68-D07F-4398-90C4-5AFCD42B5FEE" style="">4.6.3 Sending ZDP Requests</h1><div class="- topic/body body"><p class="- topic/p p">Zigbee Device Profile (ZDP) requests offer a set of functionality to manage the network, discover
      devices and services, and more.</p><p class="- topic/p p">The <a class="- topic/xref xref" href="GUID-D863D3F3-513A-46ED-BE70-98967D8AA86A.html">ZDO_ZdpReq()</a>
      function sends out a ZDP request. The <code class="+ topic/ph pr-d/codeph ph codeph">reqCluster</code> field within a  <a class="- topic/xref xref" href="GUID-3A331756-BBD3-4A81-AE1D-CB8DD4DE737A.html">ZDO_ZdpReq_t</a> type
      instance, which represents the request parameters, determines the specific action the function
      performs. The function accepts additional request parameters in the
        <code class="+ topic/ph pr-d/codeph ph codeph">req.reqPayload</code> field. This field is a union, allowing the same memory space
      to accommodate parameters for different types of requests. </p>
    <div class="- topic/p p">The user must define the request parameter’s instance in a global or file scope (using the
      static keyword) because the function operates asynchronously. <div class="- topic/note note notype note_notype" id="GUID-E61C299E-3CC5-4694-899F-4BBDBED1AEF7__NOTE_FST_SWC_SBC" data-ofbid="GUID-E61C299E-3CC5-4694-899F-4BBDBED1AEF7__NOTE_FST_SWC_SBC"><span class="note__title">Note:</span> The
        user must not reuse an instance of request parameters until the confirmation callback
        executes for the current request. This is because the callback function requires the pointer
        to the response parameters that reside in the request parameter’s instance. </div></div><p class="- topic/p p">The following sections provide some examples of issuing ZDP requests of various types. For
      additional sample application code examples that come with the SDK, go to <a class="- topic/xref xref" href="https://github.com/Microchip-MPLAB-Harmony/wireless_apps_pic32cxbz2_wbz45/blob/v3.0.1/apps/zigbee/combinedInterface/firmware/src/config/wbz451_curiosity_board/zigbee/z3device/clusters/haClusters.c" target="_blank" rel="external noopener">wireless_apps_pic32cxbz2_wbz45</a>.</p></div><article class="- topic/topic topic nested1" aria-labelledby="TOPIC_TZR_JKY_J5B__GUID-1A5E1CFA-9401-41B5-9941-8BB7A94397CC" id="TOPIC_TZR_JKY_J5B"><h2 class="- topic/title title topictitle2" id="TOPIC_TZR_JKY_J5B__GUID-1A5E1CFA-9401-41B5-9941-8BB7A94397CC" style=""> Device Discovery Requests</h2><div class="- topic/body body">
      <p class="- topic/p p">In Zigbee application development, two common tasks include retrieving the extended address
        of a remote device using a known short address and finding the short address of a device
        with a known extended address. The user accomplishes these tasks using ZDP requests of the
          <code class="+ topic/ph pr-d/codeph ph codeph">IEEE_ADDR_CLID</code> and <code class="+ topic/ph pr-d/codeph ph codeph">NWK_ADDR_CLID</code> types, respectively.
        For instance, to retrieve the extended address, the user can employ the following code: </p>
      <div class="- topic/p p">
        <pre class="+ topic/pre pr-d/codeblock pre codeblock language-c" id="TOPIC_TZR_JKY_J5B__CODEBLOCK_EK2_4VC_SBC" data-ofbid="TOPIC_TZR_JKY_J5B__CODEBLOCK_EK2_4VC_SBC"><a class="- topic/xref xref" href="GUID-5AA5929A-B977-4AA3-96D6-FFD5F0171AEB.html">ZDO_IeeeAddrReq_t</a> *ieeeAddrReq = &amp;zdpReq.req.reqPayload.ieeeAddrReq;
zdpReq.ZDO_ZdpResp = zdpIeeeAddrResp; <em class="hl-comment">//confirmation callback function</em>
zdpReq.reqCluster = IEEE_ADDR_CLID; <em class="hl-comment">//type of request</em>
ieeeAddrReq-&gt;nwkAddrOfInterest = nwkAddr; <em class="hl-comment">//the destination short address</em>
ieeeAddrReq-&gt;reqType = SINGLE_RESPONSE_REQUESTTYPE; <em class="hl-comment">//indicate that response is expected from//one node only - and not from its children</em>
ieeeAddrReq-&gt;startIndex = <span class="hl-number">0</span>;
<a class="- topic/xref xref" href="GUID-D863D3F3-513A-46ED-BE70-98967D8AA86A.html">ZDO_ZdpReq()</a>(&amp;zdpReq); <em class="hl-comment">//send the request</em></pre>
      </div><div class="- topic/p p">The implementation of the callback function for this request appears as
        follows:<pre class="+ topic/pre pr-d/codeblock pre codeblock language-c" id="TOPIC_TZR_JKY_J5B__CODEBLOCK_XHW_4VC_SBC" data-ofbid="TOPIC_TZR_JKY_J5B__CODEBLOCK_XHW_4VC_SBC"><strong class="hl-keyword">static</strong> <strong class="hl-keyword">void</strong> <span class="hl-functions">zdpIeeeAddrResp</span>(ZDO_ZdpResp_t *resp)
{
  <em class="hl-comment">//Convert the response to the appropriate type</em>
  <a class="- topic/xref xref" href="GUID-29632D53-FB9C-4F45-97C7-72D5EA7C2BAA.html">ZDO_IeeeAddrResp_t</a> *ieeeAddrResp = (ZDO_IeeeAddrResp_t *) &amp;resp-&gt;respPayload.ieeeAddrResp;
  <em class="hl-comment">//Check whether the operation is a success</em>
  <strong class="hl-keyword">if</strong> (ZDO_SUCCESS_STATUS == resp-&gt;respPayload.status)
  {
    <em class="hl-comment">//The desired extended address is contained in ieeeAddrResp-&gt;ieeeAddrRemote field</em>
    ... <em class="hl-comment">//Perform actions that required obtaining the address</em>
     <em class="hl-comment">//Post a task to notify the stack that for an appropriate task to be executed</em>
     <a class="- topic/xref xref" href="GUID-1E5183A7-C14D-4593-8EC3-C081BDD2B2BA.html">SYS_PostTask</a>(...);
  }
  <strong class="hl-keyword">else</strong>
  {
    <em class="hl-comment">//Execute required logic, e.g. perform IEEE request again</em>
  }
}</pre></div><div class="- topic/p p">
        <div class="- topic/note note notype note_notype" id="TOPIC_TZR_JKY_J5B__NOTE_N41_2XC_SBC" data-ofbid="TOPIC_TZR_JKY_J5B__NOTE_N41_2XC_SBC"><span class="note__title">Note:</span> The application must convert the response payload to a type that
          conforms to the type of the issued request. To do this, select the appropriate field from
          the union within the <code class="+ topic/ph pr-d/codeph ph codeph">respPayload</code> field.</div>
      </div></div></article><article class="- topic/topic topic nested1" aria-labelledby="TOPIC_OJT_DKY_J5B__GUID-13650DC1-4D80-4804-87B1-B70FED3B3FE5" id="TOPIC_OJT_DKY_J5B"><h2 class="- topic/title title topictitle2" id="TOPIC_OJT_DKY_J5B__GUID-13650DC1-4D80-4804-87B1-B70FED3B3FE5" style=""> Service Discovery Requests</h2><div class="- topic/body body"><p class="- topic/p p">Service discovery stands for procedures of collecting information about network devices and
        functionality (clusters) they support. With service discovery, the application on the
        current node discovers short addresses of devices that support certain input or output
        clusters and accomplish some other similar tasks.</p>
      <p class="- topic/p p">A crucial ZDP request for implementing service discovery, commonly required in
        applications, is the <code class="+ topic/ph pr-d/codeph ph codeph">MATCH_DESCRIPTOR_CLID</code> type. This request initiates a
        search for devices with registered endpoints that support the designated clusters. The
        application sends the request to a particular node using its short address or to a broadcast
        address. While the application can list multiple input and output clusters, it typically
        proves unnecessary to mention more than one cluster. This is because the target node replies
        with a list of all its endpoints that support any of the input or output clusters mentioned
        in the request. </p>
      <p class="- topic/p p">The following code issues a match descriptor request:</p>
      <div class="- topic/p p">
        <pre class="+ topic/pre pr-d/codeblock pre codeblock language-c" id="TOPIC_OJT_DKY_J5B__CODEBLOCK_OQC_QVC_SBC" data-ofbid="TOPIC_OJT_DKY_J5B__CODEBLOCK_OQC_QVC_SBC"><em class="hl-comment">//define global variables</em>
<strong class="hl-keyword">static</strong> <a class="- topic/xref xref" href="GUID-3A331756-BBD3-4A81-AE1D-CB8DD4DE737A.html">ZDO_ZdpReq_t</a> zdpReq;
...
<a class="- topic/xref xref" href="GUID-0D79C6F4-6F95-46D2-BA6D-B33C51748F2C.html">ZDO_MatchDescReq_t</a> *matchDescReq = &amp;zdpReq.req.reqPayload.matchDescReq;

zdpReq.ZDO_ZdpResp = zdpMatchDescResp; <em class="hl-comment">//confirmation callback</em>
zdpReq.reqCluster = MATCH_DESCRIPTOR_CLID; <em class="hl-comment">//set request type</em>

matchDescReq-&gt;nwkAddrOfInterest = CPU_TO_LE16(BROADCAST_SHORT_ADDRESS);
matchDescReq-&gt;profileId = CPU_TO_LE16(APP_PROFILE); <em class="hl-comment">//set profile ID</em>
matchDescReq-&gt;numInClusters = <span class="hl-number">1</span>; <em class="hl-comment">//number of clusters</em>
matchDescReq-&gt;inClusterList[<span class="hl-number">0</span>] = APP_CLUSTER; <em class="hl-comment">//set cluster ID</em>
<a class="- topic/xref xref" href="GUID-D863D3F3-513A-46ED-BE70-98967D8AA86A.html">ZDO_ZdpReq</a>(&amp;zdpReq); <em class="hl-comment">//send the request</em></pre>
      </div><p class="- topic/p p">Each reply from a discovered device received by the request's originator causes the confirmation
        callback to be called. As soon as the request is issued the stack starts a timer and waits
        for replies during a period of time specified in the
          <code class="+ topic/ph pr-d/codeph ph codeph">CS_ZDP_RESPONSE_TIMEOUT</code> parameter. When the timer elapses, the stack
        fires the callback with the <code class="+ topic/ph pr-d/codeph ph codeph">ZDO_CMD_COMPLETED_STATUS</code> status code. The stack
        calculates the default <code class="+ topic/ph pr-d/codeph ph codeph">CS_ZDP_RESPONSE_TIMEOUT</code> value in such a way that the
        devices sleeping at the moment the request is sent are not expected to have time to awake
        and answer the request. The request reaches only active devices.</p><p class="- topic/p p">Each response contains the short address, the number of matching endpoints and the list of
        matching endpoints. The confirmation callback’s implementation can be like this:</p>
      <p class="- topic/p p">When the request’s originator receives a reply from a discovered device, it triggers the
        confirmation callback. The stack initiates a timer immediately after issuing the request and
        waits for responses within the time-frame set by the
          <code class="+ topic/ph pr-d/codeph ph codeph">CS_ZDP_RESPONSE_TIMEOUT</code> parameter. After the timer’s elapses, the stack
        activates the callback with the <code class="+ topic/ph pr-d/codeph ph codeph">ZDO_CMD_COMPLETED_STATUS</code> status code. The
        stack calculates the default value of <code class="+ topic/ph pr-d/codeph ph codeph">CS_ZDP_RESPONSE_TIMEOUT</code> to exclude
        devices that are asleep at the time of the request, as they are unlikely to wake up and
        respond in time. Therefore, the request typically reaches only active devices. </p>
      <p class="- topic/p p">Each response includes the short address, the number of matching endpoints, and the list of
        those endpoints. The implementation of the confirmation callback looks as follows:</p>
      <div class="- topic/p p">
        <pre class="+ topic/pre pr-d/codeblock pre codeblock language-c" id="TOPIC_OJT_DKY_J5B__CODEBLOCK_L5Z_QVC_SBC" data-ofbid="TOPIC_OJT_DKY_J5B__CODEBLOCK_L5Z_QVC_SBC"><em class="hl-comment">//A callback function for the ZDP match descriptor request</em>
<strong class="hl-keyword">static</strong> <strong class="hl-keyword">void</strong> <span class="hl-functions">zdpMatchDescResp</span>(ZDO_ZdpResp_t *resp)
{
  <a class="- topic/xref xref" href="GUID-C3DA43BF-EBA6-4C88-8D8B-472FACDBD7D0.html">ZDO_MatchDescResp_t</a> *matchResp = &amp;resp-&gt;respPayload.matchDescResp;
  <strong class="hl-keyword">if</strong> (ZDO_CMD_COMPLETED_STATUS == resp-&gt;respPayload.status) 
  {
    <em class="hl-comment">//timeout has expired; this is the last time the callback is called</em>
    <em class="hl-comment">//for the current request</em>
  }
  <strong class="hl-keyword">else</strong> <strong class="hl-keyword">if</strong> (ZDO_SUCCESS_STATUS == resp-&gt;respPayload.status)
 {
    <em class="hl-comment">//process another response from the network: for example, the application</em>
    <em class="hl-comment">//can immediately send a ZDP request to obtain the extended address of the device</em>
    doIeeeAddrReq();
  }
  <strong class="hl-keyword">else</strong> {
    <em class="hl-comment">//process failure statuses</em>
  }
}</pre>
      </div></div></article><article class="- topic/topic topic nested1" aria-labelledby="TOPIC_JTD_BKY_J5B__GUID-420764DF-5520-4DB5-96F9-75847798676E" id="TOPIC_JTD_BKY_J5B"><h2 class="- topic/title title topictitle2" id="TOPIC_JTD_BKY_J5B__GUID-420764DF-5520-4DB5-96F9-75847798676E" style=""> Leaving the Network</h2><div class="- topic/body body">
      <p class="- topic/p p">To force a device to exit the network, send a ZDP request of the
          <code class="+ topic/ph pr-d/codeph ph codeph">MGMT_LEAVE_CLID</code> type. This request also serves to make a remote node
        leave the network. A node that exits the network becomes unreachable by remote data requests
        and cannot send data to remote nodes from the application layer. To rejoin the network, the
        node must initiate a network start request. To increase the likelihood of selecting the same
        network during network scan procedures, save the PANID value of the previous network before
        exiting and specify it as predefined during the rejoining process. </p>
      <p class="- topic/p p">The following example shows how to configure parameters for the
          <code class="+ topic/ph pr-d/codeph ph codeph">MGMT_LEAVE_CLID</code> request to force the current node to leave the
        network:</p>
      <div class="- topic/p p">
        <pre class="+ topic/pre pr-d/codeblock pre codeblock language-c" id="TOPIC_JTD_BKY_J5B__CODEBLOCK_CXX_RVC_SBC" data-ofbid="TOPIC_JTD_BKY_J5B__CODEBLOCK_CXX_RVC_SBC"><strong class="hl-keyword">static</strong> <a class="- topic/xref xref" href="GUID-3A331756-BBD3-4A81-AE1D-CB8DD4DE737A.html">ZDO_ZdpReq_t</a> zdpLeaveReq; <em class="hl-comment">//globally defined variable</em>
...
<em class="hl-comment">//set corresponding cluster ID </em>
zdpLeaveReq.reqCluster = MGMT_LEAVE_CLID; 
zdpLeaveReq.dstAddrMode = EXT_ADDR_MODE;
zdpLeaveReq.dstExtAddr = <span class="hl-number">0</span>; <em class="hl-comment">// for own node address shall be 0</em>
zdpLeaveReq.ZDO_ZdpResp = ZDO_ZdpLeaveResp; <em class="hl-comment">// callback//for own node address shall be 0 </em>
zdpLeaveReq.req.reqPayload.mgmtLeaveReq.deviceAddr = <span class="hl-number">0</span>;
<em class="hl-comment">//specify whether to force children leave or not </em>
zdpLeaveReq.req.reqPayload.mgmtLeaveReq.removeChildren = <span class="hl-number">0</span>;

<em class="hl-comment">//specify whether to perform rejoin procedure after network leave </em>
zdpLeaveReq.req.reqPayload.mgmtLeaveReq.rejoin = <span class="hl-number">0</span>;
<a class="- topic/xref xref" href="GUID-D863D3F3-513A-46ED-BE70-98967D8AA86A.html">ZDO_ZdpReq</a>(&amp;zdpLeaveReq); <em class="hl-comment">// request for network leave</em></pre>
      </div><div class="- topic/p p">The request can also be used to ask a remote node to leave the network. In addition, the user can
        configure it to compel all of its direct children to exit as well. For this purpose, the
        parameters must be set
        differently:<pre class="+ topic/pre pr-d/codeblock pre codeblock language-c" id="TOPIC_JTD_BKY_J5B__CODEBLOCK_KXP_SVC_SBC" data-ofbid="TOPIC_JTD_BKY_J5B__CODEBLOCK_KXP_SVC_SBC"><strong class="hl-keyword">static</strong> <a class="- topic/xref xref" href="GUID-3A331756-BBD3-4A81-AE1D-CB8DD4DE737A.html">ZDO_ZdpReq_t</a> zdpLeaveReq; <em class="hl-comment">//globally defined variable</em>
...
<em class="hl-comment">//set corresponding cluster ID </em>
zdpLeaveReq.reqCluster = MGMT_LEAVE_CLID; 
zdpLeaveReq.dstAddrMode = EXT_ADDR_MODE;
zdpLeaveReq.dstExtAddr = DST_EXT_ADDRESS; <em class="hl-comment">//for own node address shall be 0</em>
zdpLeaveReq.ZDO_ZdpResp = ZDO_ZdpLeaveResp; <em class="hl-comment">//confirmation callback//for own node should be 0 (or equal own address)</em>
zdpLeaveReq.req.reqPayload.mgmtLeaveReq.deviceAddr = DST_EXT_ADDRESS;
<em class="hl-comment">//specify whether to force children leave or not </em>
zdpLeaveReq.req.reqPayload.mgmtLeaveReq.removeChildren = <span class="hl-number">1</span>;

<em class="hl-comment">//specify whether to perform rejoin procedure after network leave</em>
zdpLeaveReq.req.reqPayload.mgmtLeaveReq.rejoin = <span class="hl-number">0</span>;
<a class="- topic/xref xref" href="GUID-D863D3F3-513A-46ED-BE70-98967D8AA86A.html">ZDO_ZdpReq</a>(&amp;zdpLeaveReq); <em class="hl-comment">// request for network leave</em></pre></div><div class="- topic/p p">
        <div class="- topic/note note notype note_notype" id="TOPIC_JTD_BKY_J5B__NOTE_JP5_2ZC_SBC" data-ofbid="TOPIC_JTD_BKY_J5B__NOTE_JP5_2ZC_SBC"><span class="note__title">Note:</span> If the <code class="+ topic/ph pr-d/codeph ph codeph">rejoin</code> field is set to
            <code class="+ topic/ph pr-d/codeph ph codeph">1</code>, then a destination node attempts to join the network again after the
          completing the network leave process. Use this to force a device to change its parent or
          to join with a different short address. </div>
      </div></div></article></article></main></div>
                        
                        
                        
                        
                        
                        
                    </div>
                    
                        <nav role="navigation" id="wh_topic_toc" aria-label="On this page" class="col-lg-2 d-none d-lg-block navbar d-print-none"> 
                            <div id="wh_topic_toc_content">
		                        
	                            <div class=" wh_topic_toc "><div class="wh_topic_label">On this page</div><ul><li class="topic-item"><a href="#TOPIC_TZR_JKY_J5B" data-tocid="TOPIC_TZR_JKY_J5B"> Device Discovery Requests</a></li><li class="topic-item"><a href="#TOPIC_OJT_DKY_J5B" data-tocid="TOPIC_OJT_DKY_J5B"> Service Discovery Requests</a></li><li class="topic-item"><a href="#TOPIC_JTD_BKY_J5B" data-tocid="TOPIC_JTD_BKY_J5B"> Leaving the Network</a></li></ul></div>
	                        	
                        	</div>
                        </nav>
                    
                </div>
            </div>
            
            
            
        </div> 
        <div class="mchp_disclaimer"><p class="mchp_disclaimer_text">The online versions of the documents are provided as a courtesy. Verify all content and data in the device’s PDF documentation found on the device product page.</p></div><footer class="navbar navbar-default wh_footer">
  <div class=" footer-container mx-auto ">
    <div class="footer">
  <div class="mchp-wh-footer">
    <div class="mchp-footer">
      <div class="mchp-footer-tier1">
        <div class="spacer"></div>
        <div class="mchp-footer-container">
          <div class="mchp-footer-links mchp-social-media-links">
            <div class="mchp-component-items">
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://www.facebook.com/pages/Microchip-Technology-Inc/20320981741" target="_blank">
                  <img class="cmp-image__image" alt="Microchip Facebook" src="oxygen-webhelp/template/resources/images/201016-corp-facebook.png"/>
                </a>
              </div>
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://www.linkedin.com/company/microchip-technology" target="_blank">
                  <img class="cmp-image__image" alt="Microchip LinkedIn" src="oxygen-webhelp/template/resources/images/201016-corp-linkedin.png"/>
                </a>
              </div>
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://twitter.com/MicrochipTech" target="_blank">
                  <img class="cmp-image__image" alt="Microchip Twitter" src="oxygen-webhelp/template/resources/images/201016-corp-twitter.png"/>
                </a>
              </div>
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://www.youtube.com/user/MicrochipTechnology" target="_blank">
                  <img class="cmp-image__image" alt="Microchip YouTube" src="oxygen-webhelp/template/resources/images/201016-corp-youtube.png"/>
                </a>
              </div>
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://www.instagram.com/microchiptechnologyinc/" target="_blank">
                  <img class="cmp-image__image" alt="Microchip Instagram" src="oxygen-webhelp/template/resources/images/201016-corp-instagram.png"/>
                </a>
              </div>
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://www.weibo.com/microchiptech" target="_blank">
                  <img class="cmp-image__image" alt="Microchip Weibo" src="oxygen-webhelp/template/resources/images/201016-corp-weibo.png"/>
                </a>
              </div>
              <div class="mchp-component-item">
                <a class="cmp-image__link" href="https://www.microchip.com/en-us/about/blog" target="_blank">
                  <img class="cmp-image__image" alt="Microchip Blog" src="oxygen-webhelp/template/resources/images/201016-corp-blog.png"/>
                </a>
              </div>
            </div>
          </div>
          <div class="mchp-footer-links">
            <div class="mchp-component-items">
              <div class="mchp-component-item">
                <div class="link">
                  <a href="https://www.microchip.com/about-us/contact-us" class="mchp-link__link">Contact</a>
                  <span class="mchp-link__separator">|</span>
                </div>
              </div>
              <div class="mchp-component-item ">
                <div class="link">
                  <a href="https://www.microchip.com/en-us/about/legal-information" class="mchp-link__link">Legal</a>
                  <span class="mchp-link__separator">|</span>
                </div>
              </div>
              <div class="mchp-component-item ">
                <div class="link">
                  <a href="https://www.microchip.com/en-us/about/legal-information/privacy-policy" class="mchp-link__link">Privacy Policy</a>
                  <span class="mchp-link__separator">|</span>
                </div>
              </div>
              <div class="mchp-component-item ">
                <div class="link">
                  <a href="https://www.microchip.com/en-us/about/legal-information/microchip-cookie-statement" class="mchp-link__link">Cookies</a>
                  <span class="mchp-link__separator">|</span>
                </div>
              </div>
              <div class="mchp-component-item">
                <div class="link">
                  <a href="https://careers.microchip.com/" class="mchp-link__link">Careers</a>
                  <span class="mchp-link__separator"></span>
                </div>
              </div>
            </div>
          </div>
          <div class="mchp-footer-newsletter">
            <div class="cmp-text">
              <p>Stay on the leading edge with our blog</p>
            </div>
            <div class="mchp-button-wrapper">
              <a role="button" href="https://www.microchip.com/en-us/about/blog" class="mchp-button mchp-button-regular solid">
                <span class="mchp-button__span">MicroSolutions</span>
              </a>
            </div>
          </div>
        </div>
        <div class="graphic">
          <img src="oxygen-webhelp/template/resources/images/footer-graphic.png"/>
        </div>
      </div>
      <div class="mchp-footer-tier2">
        <p class="mchp-copyright">© Copyright 1998-2022 Microchip Technology Inc. All rights reserved.</p>
      </div>
    </div>
  </div>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async="true" src="https://www.googletagmanager.com/gtag/js?id=UA-2724382-19"></script>
  <script>
    window.dataLayer = window.dataLayer || [];  
    function gtag(){dataLayer.push(arguments);}  
    gtag('js', new Date());   
    gtag('config', 'UA-2724382-19');
  </script>
  
  <script type="text/javascript">_satellite.pageBottom();</script><!-- Adobe Analytics -->
  <script type="text/javascript" src="mchp-js/prepend.js"></script><!-- Package for viewing PDFs on mobile devices -->
  
</div>
  </div>
</footer>
        
        <div id="go2top" class="d-print-none">
            <span class="oxy-icon oxy-icon-up"></span>
        </div>
        
        <div id="modal_img_large" class="modal">
            <span class="close oxy-icon oxy-icon-remove"></span>
            <div id="modal_img_container"></div>
            <div id="caption"></div>
        </div>
        
        
        
       
        </body>
</html>