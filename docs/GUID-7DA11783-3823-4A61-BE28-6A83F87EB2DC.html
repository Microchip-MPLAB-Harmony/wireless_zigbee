<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE11" /><meta name="copyright" content="(C) Copyright 2023" />
<meta name="DC.rights.owner" content="(C) Copyright 2023" />
<meta name="generator" content="DITA-OT" /><meta name="DC.type" content="topic" />
<meta name="DC.title" content="Network Start" />
<meta name="DC.relation" scheme="URI" content="GUID-72AB5A6D-8A28-4640-A202-8B23B24F01F3.html" />
<meta name="DC.format" content="XHTML" />
<meta name="DC.identifier" content="GUID-7DA11783-3823-4A61-BE28-6A83F87EB2DC" />
<meta name="DC.language" content="en-US" />
<link rel="stylesheet" type="text/css" href="stylesheets/atmel.css" />
<title>Network Start</title>
<meta name="Microsoft.Help.Id" content="GUID-1DD68C79-8AC2-497D-A1BB-49D92D3FDAB8-GUID-7DA11783-3823-4A61-BE28-6A83F87EB2DC" />
<meta name="Microsoft.Help.TocParent" content="GUID-1DD68C79-8AC2-497D-A1BB-49D92D3FDAB8-GUID-72AB5A6D-8A28-4640-A202-8B23B24F01F3" />
<meta name="Microsoft.Help.TocOrder" content="0" />
<meta name="Microsoft.Help.Locale" content="en-US" />
<meta name="Microsoft.Help.TopicLocale" content="en-US" />
<meta name="Microsoft.Help.DisplayVersion" content="MPLAB Harmony Wireless Zigbee Reference 3 08/2023" />
<script language="javascript">
       
       if (window.parent.location.protocol != 'file:') {
				document.addEventListener('click', function(e) {
				    if (e.target) {
               if (e.target.nodeName == "A" ) {
                    if (!e.target.target) {
                      e.preventDefault();
                      e.stopPropagation();
                              
                      var origUrl = window.parent.location.href.substr(0, window.parent.location.href.indexOf("?"));
                      if (origUrl.length === 0) {
                          origUrl = window.parent.location.href;
                      }
                      var href= e.target.getAttribute("href");
                      var parts = href.split("#");
          
                      var url = "";
                      if (parts.length == 2 ) {
                        if (!parts[0].length) {
                            url = window.parent.location.search.replace('?','')
                        } else {
                            url = parts[0].replace('.html','');
                        }
                      } else {
                        url = parts[0].replace('.html','');
                      }

                      if (parts.length == 2) {
                          url += "#" + parts[1];
                      }
    
                      window.parent.location.href = origUrl + "?" + url;

                      return false;
                    }
               }
            }
				});
			}

		</script><script language="javascript">
         
         function copyContent(content, button) {
         
            var textArea = document.createElement("textarea");
            
            // Place in the top-left corner of screen regardless of scroll position.
            textArea.style.position = 'fixed';
            textArea.style.top = 0;
            textArea.style.left = 0;
            
            // Ensure it has a small width and height. Setting to 1px / 1em
            // doesn't work as this gives a negative w/h on some browsers.
            textArea.style.width = '2em';
            textArea.style.height = '2em';
            
            // We don't need padding, reducing the size if it does flash render.
            textArea.style.padding = 0;
            
            // Clean up any borders.
            textArea.style.border = 'none';
            textArea.style.outline = 'none';
            textArea.style.boxShadow = 'none';
            
            // Avoid flash of the white box if rendered for any reason.
            textArea.style.background = 'transparent';
            
            textArea.value = content;
            
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
               var successful = document.execCommand('copy');
               var msg = successful ? 'successful' : 'unsuccessful';
               if (!button.classList.contains("copied")){
                  button.textContent = "Copied";
                  button.classList.add("copied");
                  setTimeout(function(){
                     button.textContent = "Copy";
                     button.classList.remove("copied");
                  },1000);
               }
            } catch (err) {
               console.log('Oops, unable to copy');
            }
            
            document.body.removeChild(textArea);
         }
         
         function cpy(id, button) {
            var element = document.getElementById(id);
            var content = element.getAttribute("content");
            
            copyContent(content, button);
         }
         
         document.addEventListener("DOMContentLoaded", function(event) {
            document.querySelectorAll(".codeblock").forEach(function(elem) {
               elem.style.position = "relative";
               var copy = document.createElement("button");
               copy.textContent = "Copy";
               copy.setAttribute("class", "copy-code");
               
               var content = elem.textContent;
               
               copy.addEventListener("click", function(){
                  copyContent(content, copy);
               });
               
               elem.addEventListener("mouseenter", function(evt){
                  elem.prepend(copy);
               });
            });
            
            document.querySelectorAll(".codeblock").forEach(function(elem) {
               elem.addEventListener("mouseleave", function(evt){
                  document.querySelector(".copy-code").remove();
               });
            });
         });
         
      </script><script language="javascript">
          
          // Add the MathML namespace to html
          var html = document.getElementsByTagName("html")[0],
          head = document.getElementsByTagName("head")[0];
          
          var mathJax = document.createElement("script");
          mathJax.src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML";
          head.appendChild(mathJax);
          
          html.setAttribute("xmlns:m","http://www.w3.org/1998/Math/MathML");
          
          function inIframe() { try { return window.self !== window.top; } catch (e) { return true; } }
          
          if (!inIframe()) { 
          
          var Default = "index.html?GUID-7DA11783-3823-4A61-BE28-6A83F87EB2DC"; 
          
          var displaylocation = "value" + window.location.href;
          
          var GUIDS = displaylocation.split('GUID');          
          
          if (displaylocation.indexOf('#GUID') != -1) {            
          var First = GUIDS[1].split('.html');  
          if (GUIDS[3]){First = GUIDS[2].split('.html');}
          if (GUIDS[4]){First = GUIDS[3].split('.html');}
          if (GUIDS[5]){First = GUIDS[4].split('.html');}
          
          var Second = GUIDS[2].split('#');   
          if (GUIDS[3]){Second = GUIDS[3].split('#');}
          if (GUIDS[4]){Second = GUIDS[4].split('#');}
          if (GUIDS[5]){Second = GUIDS[5].split('#');}
          
          Default = "index.html?" + "GUID" + First[0] + "GUID" + Second[0];     
          }                    
          window.top.location = Default;
          }       
          
        </script><link rel="stylesheet" type="text/css" href="syntax-highlight.css" /><style xml:space="">
        
          button.copy-code{
            display:none;
            padding:0.7em 1.4em;
            margin:0 0.3em 0.3em 0;
            border-radius:0.15em;
            box-sizing: border-box;
            text-decoration:none;
            font-family:'Roboto',sans-serif;
            text-transform:uppercase;
            font-weight:400;
            color:#FFFFFF;
            background-color:#9c9c9c;
            box-shadow:inset 0 -0.6em 0 -0.35em rgba(0,0,0,0.17);
            text-align:center;
            position:relative;
            border: 0;
            float: right;
            border-radius: .5em;
            cursor: pointer;
          }
          button.copy-code:active{
            top:0.1em;
          }
          
          pre:hover button.copy-code{
            display: inline-block !important;
          }
          button.copy-code.copied {
            cursor: default !important;
          }
          
          
          @media all and (max-width:30em){
            button.copy-code{
              display:block;
              margin:0.4em auto;
            }
          }
        
        
      </style><link rel="stylesheet" type="text/css" href="syntax-highlight.css" /></head>
<body id="GUID-7DA11783-3823-4A61-BE28-6A83F87EB2DC">

    <h1 class="title topictitle1" id="GUID-7DA11783-3823-4A61-BE28-6A83F87EB2DC__GUID-4526234C-9F5F-4A6F-9EF5-AB11F0F725A5" style="">Network Start</h1>
    <div class="body">
        <p class="p">Starting network on a certain device means forming a new network if the device is the
            coordinator or discovering and joining to an existent network if the device is a router
            or an end device. In both cases the user should call the <a class="xref" href="GUID-CB1C7F82-4A2A-469B-836B-A05E9B649FFA.html">ZDO_StartNetworkReq_t</a> function. The function takes a pointer to an instance
            of <a class="xref" href="GUID-CB1C7F82-4A2A-469B-836B-A05E9B649FFA.html">ZDO_StartNetworkReq_t</a> type as an argument. The only field to be specified in
            the request parameters is a pointer to the confirmation callback given in the
                <code class="ph codeph">ZDO_StartNetworkConf</code> field. Upon request completion the APS layer
            fills the <code class="ph codeph">confirm</code> field with the execution status and information about
            the network entered by the device. A pointer to this field is received as the argument
            of the callback. The following code sample demonstrates how to perform a network
            start.</p>

        <pre class="pre">//The parameters for the network start request
<a class="xref" href="GUID-CB1C7F82-4A2A-469B-836B-A05E9B649FFA.html">ZDO_StartNetworkReq_t</a> networkParams;

//the definition of the callback for the network start request
static void ZDO_StartNetworkConf(<a class="xref" href="GUID-BBEFA87B-3D91-4666-AF5C-7D8DD7D8937C.html">ZDO_StartNetworkConf_t</a> *confirmInfo)
{
    //code goes here
}
...
//configure the request parameters
networkParams.ZDO_StartNetworkConf = ZDO_StartNetworkConf;
//send the request 
<a class="xref" href="GUID-8149671D-FC16-4A0F-BA99-5EAFE079011F.html">ZDO_StartNetworkReq</a>(&amp;networkParams);
</pre>

        <p class="p">As for the most of requests in the stack, the <code class="ph codeph">status</code> field of
            confirmation parameters reports whether the request has been executed successfully. The
            ZDO_SUCCESS_STATUS value indicates that the device has successfully formed or joined the
            network. In this case network parameters, the short address assigned to the device and
            the parent address are received as well (see documentation of
            ZDO_StartNetworkConf_t).</p>

    </div>

    <div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="GUID-72AB5A6D-8A28-4640-A202-8B23B24F01F3.html">ZDO Component Usage</a></div>
</div>
</div><div class="topic nested1" aria-labelledby="TOPIC_GDS_PWY_J5B__GUID-9728EB0D-79B3-47E3-8853-C5F0E48C44D0" id="TOPIC_GDS_PWY_J5B">
        <h2 class="title topictitle2" id="TOPIC_GDS_PWY_J5B__GUID-9728EB0D-79B3-47E3-8853-C5F0E48C44D0" style="">Configuring network start</h2>
        <div class="body">
            <p class="p">The stack provides a user with means of further control of a network start. The way
                the network start goes depends on the ConfigServer parameters with the ID
                    <code class="ph codeph">CS_JOIN_CONTROL_ID</code>. The application can fill a structure of
                    <a class="xref" href="GUID-8E08DD47-8117-4B3D-805B-E7223B1A643F.html">NWK_JoinControl_t</a> type and set it a the value of the parameter, using
                the <a class="xref" href="GUID-16BDBF75-3A65-47E9-B462-30D3C883F0AA.html">CS_WriteParameter</a> value, at any item before network start.</p>

            <p class="p">The structure includes the <code class="ph codeph">method</code> field, which sets the type of
                network start. Possible values are given in the NWK_JoinMethod_t enumeration. The
                default value is NWK_JOIN_BY_DEFAULT, which makes the stack select a network start
                type on the basis of ConfigServer parameters. Basically, if device's type is the
                coordinator, a new network is formed, and otherwise if the extended PANID of the
                network (CS_EXT_PANID) is unknown the <em class="ph i">association</em> procedure is used, and if
                the extended PANID is already known the <em class="ph i">rejoining</em> procedure is applied. A
                particular method for the network start is selecting by assigning a different value
                to the <code class="ph codeph">method</code> field. The application can also set any appropriate
                value, though is shall ensure that all parameters required by the method are set or,
                otherwise, network start will fail.</p>

            <p class="p">Other fields, all of boolean type, of the <a class="xref" href="GUID-8E08DD47-8117-4B3D-805B-E7223B1A643F.html">NWK_JoinControl_t</a> structure are (the application can set these fields as
                it seems appropriate regardless of the <code class="ph codeph">method</code> field's value):</p>

            <ul class="ul" id="TOPIC_GDS_PWY_J5B__UL_IHW_Y42_KTB">
                <li class="li" id="TOPIC_GDS_PWY_J5B__GUID-B632EC2D-389B-4505-AB60-7F3E3001B4BA"><code class="ph codeph">secured</code> -
                    determines if frames exchanged during network start are encrypted with the
                    network key. The network key should be set in the CS_NETWORK_KEY parameter. </li>

                <li class="li" id="TOPIC_GDS_PWY_J5B__GUID-C9CA0B86-41C7-487F-AC99-8548FA1F7E55"><code class="ph codeph">discoverNetworks</code>
                    - causes the stack to scan for networks during network start (if set to
                        <code class="ph codeph">true</code>) or not. During scanning, the neighbor table is filled
                    with entries describing discovered devices. So if this field is set to
                        <code class="ph codeph">false</code> the application can fill neighbor table by itself. </li>

                <li class="li" id="TOPIC_GDS_PWY_J5B__GUID-43D1DD34-5CBF-4142-83B8-A3FC25A3C56B"><code class="ph codeph">annce</code> -
                    determines if a device announcement frame will be sent after network start,
                    notifying other devices that a new node has entered the network. The application
                    on a node can track device announcement frames sent by its child nodes if it
                    subscribes to the BC_EVENT_DEVICE_ANNCE event, using the <a class="xref" href="GUID-797FDA4F-317D-4F69-A613-0F555135EB8F.html">SYS_SubscribeToEvent()</a> function. </li>

            </ul>

            <p class="p">In the following code example the node is configured to join the network via rejoin
                but without sending a device announcement frame on successful rejoin: </p>

            <pre class="pre">NWK_JoinControl_t joinControl = {
  .method = NWK_JOIN_VIA_REJOIN,  //CS_EXT_PANID must be set
  .secured = true,
  .discoverNetworks = true,
  .annce = false//Device announcement won't be sent after network join
};
<a class="xref" href="GUID-16BDBF75-3A65-47E9-B462-30D3C883F0AA.html">CS_WriteParameter</a>(CS_JOIN_CONTROL_ID, &amp;joinControl); //Set the parameter in ConfigServer</pre>

        </div>

    </div>

</body>
</html>