<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>PIC32CX-BZ Zigbee API Reference: apsCryptoKeys.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PIC32CX-BZ Zigbee API Reference</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">apsCryptoKeys.h</div>  </div>
</div>
<div class="contents">
<a href="aps_crypto_keys_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/**************************************************************************/</span>
<a name="l00019"></a>00019 <span class="preprocessor">#if !defined _APS_CRYPTO_KEYS_H</span>
<a name="l00020"></a>00020 <span class="preprocessor"></span><span class="preprocessor">#define _APS_CRYPTO_KEYS_H</span>
<a name="l00021"></a>00021 <span class="preprocessor"></span>
<a name="l00022"></a>00022 <span class="comment">/******************************************************************************</span>
<a name="l00023"></a>00023 <span class="comment">                               Includes section</span>
<a name="l00024"></a>00024 <span class="comment"> ******************************************************************************/</span>
<a name="l00025"></a>00025 <span class="preprocessor">#include &lt;nwk.h&gt;</span>
<a name="l00026"></a>00026 
<a name="l00027"></a>00027 <span class="comment">/******************************************************************************</span>
<a name="l00028"></a>00028 <span class="comment">                              Define(s) section</span>
<a name="l00029"></a>00029 <span class="comment"> ******************************************************************************/</span>
<a name="l00031"></a><a class="code" href="aps_crypto_keys_8h.html#a84dbbe2d16ad8b04b2eee8f5a8ad6307">00031</a> <span class="preprocessor">#define APS_DEFAULT_LINK_KEY \</span>
<a name="l00032"></a>00032 <span class="preprocessor">  {0x5a, 0x69, 0x67, 0x42, 0x65, 0x65, 0x41, 0x6c,\</span>
<a name="l00033"></a>00033 <span class="preprocessor">   0x6c, 0x69, 0x61, 0x6e, 0x63, 0x65, 0x30, 0x39}</span>
<a name="l00034"></a>00034 <span class="preprocessor"></span>
<a name="l00035"></a><a class="code" href="aps_crypto_keys_8h.html#a581d4c2657a00e894e650aeb41806c4b">00035</a> <span class="preprocessor">#define APS_KEY_HANDLE_IS_VALID(handle) ((APS_KeyPairIndex_t)0 &lt;= (handle).idx)</span>
<a name="l00036"></a>00036 <span class="preprocessor"></span>
<a name="l00037"></a><a class="code" href="aps_crypto_keys_8h.html#a13f6a12c2990da1e8de138657abe016c">00037</a> <span class="preprocessor">#define APS_KEYS_FOUND(handle) APS_KEY_HANDLE_IS_VALID(handle)</span>
<a name="l00038"></a>00038 <span class="preprocessor"></span>
<a name="l00040"></a><a class="code" href="aps_crypto_keys_8h.html#a1b7ea22e67f104ae03d70a68bfe08011">00040</a> <span class="preprocessor">#define APS_SECURED_WITH_ANY_LINK_KEY_STATUS(securityStatus) \</span>
<a name="l00041"></a>00041 <span class="preprocessor">  ((APS_SECURED_LINK_KEY_STATUS == securityStatus) || \</span>
<a name="l00042"></a>00042 <span class="preprocessor">   (APS_SECURED_TRUST_CENTER_LINK_KEY_STATUS == securityStatus) || \</span>
<a name="l00043"></a>00043 <span class="preprocessor">   (APS_SECURED_HASH_OF_TRUST_CENTER_LINK_KEY_STATUS == securityStatus))</span>
<a name="l00044"></a>00044 <span class="preprocessor"></span>
<a name="l00047"></a><a class="code" href="aps_crypto_keys_8h.html#a10dfee2315fd471b723df2254b8f980b">00047</a> <span class="preprocessor">#define APS_KEY_PAIR_INITIAL -1</span>
<a name="l00048"></a>00048 <span class="preprocessor"></span><span class="preprocessor">#define APS_KEY_PAIR_FINISH  -2</span>
<a name="l00049"></a>00049 <span class="preprocessor"></span>
<a name="l00050"></a><a class="code" href="aps_crypto_keys_8h.html#ad24ce0b25a4ce8da014263b455f90453">00050</a> <span class="preprocessor">#define APS_KEY_PAIR_ALLOC_FAIL -3</span>
<a name="l00051"></a>00051 <span class="preprocessor"></span>
<a name="l00052"></a><a class="code" href="aps_crypto_keys_8h.html#a297ecf99afc8646345e83f5119deadba">00052</a> <span class="preprocessor">#define APS_KEY_PAIR_NOT_FOUND  -4</span>
<a name="l00053"></a>00053 <span class="preprocessor"></span>
<a name="l00054"></a><a class="code" href="aps_crypto_keys_8h.html#a37440f0196ed135b201725f8762ff7fc">00054</a> <span class="preprocessor">#define APS_KEY_PAIR_INVALID_PARAMETER  -5</span>
<a name="l00055"></a>00055 <span class="preprocessor"></span>
<a name="l00056"></a><a class="code" href="aps_crypto_keys_8h.html#aa3410e3ca49277f0647fa058dea5817f">00056</a> <span class="preprocessor">#define APS_KEY_PAIR_NO_INIT  -6</span>
<a name="l00057"></a>00057 <span class="preprocessor"></span>
<a name="l00060"></a><a class="code" href="aps_crypto_keys_8h.html#a35708bab19852a95c8bd75ed90411c52">00060</a> <span class="preprocessor">#define APS_RESET_MASTER_KEY 0x01 </span>
<a name="l00061"></a><a class="code" href="aps_crypto_keys_8h.html#a398eebf92d10580c4ff5d2351c17219e">00061</a> <span class="preprocessor">#define APS_RESET_LINK_KEY   0x02 </span>
<a name="l00062"></a><a class="code" href="aps_crypto_keys_8h.html#ade9ca80371aa20a8d27e3b40dca213c7">00062</a> <span class="preprocessor">#define APS_RESET_COUNTERS   0x04 </span>
<a name="l00064"></a>00064 <span class="preprocessor"></span><span class="comment">/******************************************************************************</span>
<a name="l00065"></a>00065 <span class="comment">                                Types section</span>
<a name="l00066"></a>00066 <span class="comment"> ******************************************************************************/</span>
<a name="l00067"></a>00067 <span class="comment">/* Type of outgoing frame counter. See ZigBee spec r19, Table 4.37. */</span>
<a name="l00068"></a>00068 <span class="keyword">typedef</span> uint32_t ApsOutFrameCounter_t;
<a name="l00069"></a>00069 
<a name="l00070"></a>00070 <span class="comment">/* Type of incoming frame counter. See ZigBee spec r19, Table 4.37. */</span>
<a name="l00071"></a>00071 <span class="keyword">typedef</span> uint32_t ApsInFrameCounter_t;
<a name="l00072"></a>00072 
<a name="l00073"></a>00073 <span class="comment">/* Type of Key-Pair Index. */</span>
<a name="l00074"></a>00074 <span class="keyword">typedef</span> int16_t APS_KeyPairIndex_t;
<a name="l00075"></a>00075 <span class="comment">/* Type of size of APS Key-Pair Set. */</span>
<a name="l00076"></a>00076 <span class="keyword">typedef</span> uint16_t APS_KeyPairAmount_t;
<a name="l00077"></a>00077 
<a name="l00079"></a><a class="code" href="struct___a_p_s___key_handle__t.html">00079</a> <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="struct___a_p_s___key_handle__t.html">_APS_KeyHandle_t</a>
<a name="l00080"></a>00080 {
<a name="l00082"></a><a class="code" href="struct___a_p_s___key_handle__t.html#a63d5bbce04879c17850d928e45cae52f">00082</a>   APS_KeyPairIndex_t <a class="code" href="struct___a_p_s___key_handle__t.html#a63d5bbce04879c17850d928e45cae52f">idx</a>;
<a name="l00084"></a><a class="code" href="struct___a_p_s___key_handle__t.html#a93722abe57c62c5ff3d6679f01330c8b">00084</a>   uint8_t <a class="code" href="struct___a_p_s___key_handle__t.html#a93722abe57c62c5ff3d6679f01330c8b">flags</a>;
<a name="l00085"></a>00085 } <a class="code" href="aps_crypto_keys_8h.html#a539c67d4fadda6e0981e3eec52aa219e">APS_KeyHandle_t</a>;
<a name="l00086"></a>00086 
<a name="l00087"></a><a class="code" href="aps_crypto_keys_8h.html#a373f6961a6a46a46b8129f224fffe2ee">00087</a> <span class="keyword">typedef</span> <span class="keyword">enum</span>
<a name="l00088"></a>00088 {
<a name="l00090"></a><a class="code" href="aps_crypto_keys_8h.html#a373f6961a6a46a46b8129f224fffe2eeaea4b0f5bbe36e1fc901840e4a767a551">00090</a>   <a class="code" href="aps_crypto_keys_8h.html#a373f6961a6a46a46b8129f224fffe2eeaea4b0f5bbe36e1fc901840e4a767a551">APS_FLAG_NONE</a> = 0x00,
<a name="l00092"></a><a class="code" href="aps_crypto_keys_8h.html#a373f6961a6a46a46b8129f224fffe2eea03333b5db0727b35cb923b8a40b58912">00092</a>   <a class="code" href="aps_crypto_keys_8h.html#a373f6961a6a46a46b8129f224fffe2eea03333b5db0727b35cb923b8a40b58912">APS_FLAG_KEY_PAIR_USED</a> = 0x01,
<a name="l00094"></a><a class="code" href="aps_crypto_keys_8h.html#a373f6961a6a46a46b8129f224fffe2eead1d37de3f6681dcb1176a923c5773730">00094</a>   <a class="code" href="aps_crypto_keys_8h.html#a373f6961a6a46a46b8129f224fffe2eead1d37de3f6681dcb1176a923c5773730">APS_FLAG_KEY_PAIR_AUTHORIZED</a> = 0x02,
<a name="l00096"></a><a class="code" href="aps_crypto_keys_8h.html#a373f6961a6a46a46b8129f224fffe2eea3364c1a924a8c6478c427da72ec6d342">00096</a>   <a class="code" href="aps_crypto_keys_8h.html#a373f6961a6a46a46b8129f224fffe2eea3364c1a924a8c6478c427da72ec6d342">APS_FLAG_KEY_PAIR_GLOBAL</a> = 0x04,
<a name="l00099"></a><a class="code" href="aps_crypto_keys_8h.html#a373f6961a6a46a46b8129f224fffe2eeac425a5ecf22e2143e177f1b92dc5064b">00099</a>   <a class="code" href="aps_crypto_keys_8h.html#a373f6961a6a46a46b8129f224fffe2eeac425a5ecf22e2143e177f1b92dc5064b">APS_FLAG_KEY_PAIR_PRIMARY_GLOBAL</a> = 0x08,
<a name="l00101"></a><a class="code" href="aps_crypto_keys_8h.html#a373f6961a6a46a46b8129f224fffe2eeaa38779a2638418e9ece9a305ead9727e">00101</a>   <a class="code" href="aps_crypto_keys_8h.html#a373f6961a6a46a46b8129f224fffe2eeaa38779a2638418e9ece9a305ead9727e">APS_FLAG_KEY_PAIR_TC</a> = 0x10,
<a name="l00103"></a><a class="code" href="aps_crypto_keys_8h.html#a373f6961a6a46a46b8129f224fffe2eeab774844334c29664bd8136a545bd69fe">00103</a>   <a class="code" href="aps_crypto_keys_8h.html#a373f6961a6a46a46b8129f224fffe2eeab774844334c29664bd8136a545bd69fe">APS_FLAG_KEY_PAIR_UPDATED</a> = 0x20,
<a name="l00104"></a>00104 } <a class="code" href="aps_crypto_keys_8h.html#a373f6961a6a46a46b8129f224fffe2ee">APS_KeyPairFlags_t</a>;
<a name="l00105"></a>00105 
<a name="l00107"></a><a class="code" href="aps_crypto_keys_8h.html#a5f81fc6b9c522838dcf58756fc77a000">00107</a> <span class="keyword">typedef</span> uint8_t <a class="code" href="aps_crypto_keys_8h.html#a5f81fc6b9c522838dcf58756fc77a000">APS_KeyResetFlags_t</a>;
<a name="l00108"></a>00108 
<a name="l00109"></a>00109 <span class="comment">/******************************************************************************</span>
<a name="l00110"></a>00110 <span class="comment">                              Prototypes section</span>
<a name="l00111"></a>00111 <span class="comment"> ******************************************************************************/</span>
<a name="l00112"></a>00112 <span class="comment">/**************************************************************************/</span>
<a name="l00117"></a><a class="code" href="aps_crypto_keys_8h.html#ae23d1ad1a636e917f5634c06c6f7dcf2">00117</a> INLINE <a class="code" href="struct___a_p_s___key_handle__t.html">APS_KeyHandle_t</a> <a class="code" href="aps_crypto_keys_8h.html#ae23d1ad1a636e917f5634c06c6f7dcf2" title="Returns key handle in uninitialized state.">APS_KeyHandleUninitialized</a>(<span class="keywordtype">void</span>)
<a name="l00118"></a>00118 {
<a name="l00119"></a>00119   <a class="code" href="struct___a_p_s___key_handle__t.html">APS_KeyHandle_t</a> keyHandle =
<a name="l00120"></a>00120   {
<a name="l00121"></a>00121     .<a class="code" href="struct___a_p_s___key_handle__t.html#a63d5bbce04879c17850d928e45cae52f">idx</a> = <a class="code" href="aps_crypto_keys_8h.html#a10dfee2315fd471b723df2254b8f980b">APS_KEY_PAIR_INITIAL</a>,
<a name="l00122"></a>00122     .flags = 0U
<a name="l00123"></a>00123   };
<a name="l00124"></a>00124 
<a name="l00125"></a>00125   <span class="keywordflow">return</span> keyHandle;
<a name="l00126"></a>00126 }
<a name="l00127"></a>00127 
<a name="l00128"></a>00128 <span class="comment">/**************************************************************************/</span>
<a name="l00177"></a>00177 <a class="code" href="struct___a_p_s___key_handle__t.html">APS_KeyHandle_t</a> <a class="code" href="group__aps__security.html#ga4d97ec9bad11b340c8fa114db1d7a92c" title="Sets a link key for the device with a given extended address.">APS_SetLinkKey</a>(<span class="keyword">const</span> <a class="code" href="mac_addr_8h.html#a5b2913b1523fd1ce0a399c4fb047cc8b" title="Extended address type declaration.">ExtAddr_t</a> *<span class="keyword">const</span> deviceAddress,
<a name="l00178"></a>00178   <span class="keyword">const</span> uint8_t *<span class="keyword">const</span> linkKey);
<a name="l00179"></a>00179 
<a name="l00180"></a>00180 <span class="comment">/**************************************************************************/</span>
<a name="l00237"></a>00237 <a class="code" href="struct___a_p_s___key_handle__t.html">APS_KeyHandle_t</a> <a class="code" href="group__aps__security.html#gaf6bad000710b8a34e6493005132fe288" title="Sets a master key for the device with a given extended address.">APS_SetMasterKey</a>(<span class="keyword">const</span> <a class="code" href="mac_addr_8h.html#a5b2913b1523fd1ce0a399c4fb047cc8b" title="Extended address type declaration.">ExtAddr_t</a> *<span class="keyword">const</span> deviceAddress,
<a name="l00238"></a>00238   <span class="keyword">const</span> uint8_t *<span class="keyword">const</span> masterKey);
<a name="l00239"></a>00239 
<a name="l00240"></a>00240 <span class="comment">/**************************************************************************/</span>
<a name="l00267"></a>00267 <a class="code" href="struct___a_p_s___key_handle__t.html">APS_KeyHandle_t</a> <a class="code" href="group__aps__security.html#ga3229d2abe9efd3d4e35cd4338cfaf988" title="Find the master key or the link key corresponding to a given extended address.">APS_FindKeys</a>(<span class="keyword">const</span> <a class="code" href="mac_addr_8h.html#a5b2913b1523fd1ce0a399c4fb047cc8b" title="Extended address type declaration.">ExtAddr_t</a> *<span class="keyword">const</span> deviceAddress);
<a name="l00268"></a>00268 
<a name="l00269"></a>00269 <span class="comment">/**************************************************************************/</span>
<a name="l00300"></a>00300 uint8_t* <a class="code" href="group__aps__security.html#ga7d48f855d7bdc744b7f3bc5e5e9d57e4" title="Get a pointer to the master key value by a given key handle.">APS_GetMasterKey</a>(<span class="keyword">const</span> <a class="code" href="struct___a_p_s___key_handle__t.html">APS_KeyHandle_t</a> handle);
<a name="l00301"></a>00301 
<a name="l00302"></a>00302 <span class="comment">/**************************************************************************/</span>
<a name="l00332"></a>00332 uint8_t* <a class="code" href="group__aps__security.html#gaf284854b8e67a19aa3ecdab2271b0705" title="Get a pointer to the link key value by a given key handle.">APS_GetLinkKey</a>(<span class="keyword">const</span> <a class="code" href="struct___a_p_s___key_handle__t.html">APS_KeyHandle_t</a> handle);
<a name="l00333"></a>00333 
<a name="l00334"></a>00334 <span class="comment">/**************************************************************************/</span>
<a name="l00345"></a>00345 <span class="keywordtype">bool</span> <a class="code" href="group__aps__security.html#gae70f5ad61efae9a6f5d9b312a9a885ca" title="Delete key-pair - master and link keys.">APS_DeleteKeyPair</a>(<a class="code" href="mac_addr_8h.html#a5b2913b1523fd1ce0a399c4fb047cc8b" title="Extended address type declaration.">ExtAddr_t</a> *<span class="keyword">const</span> deviceAddress, <span class="keyword">const</span> <span class="keywordtype">bool</span> notify);
<a name="l00346"></a>00346 
<a name="l00347"></a>00347 <span class="comment">/**************************************************************************/</span>
<a name="l00370"></a>00370 <a class="code" href="struct___a_p_s___key_handle__t.html">APS_KeyHandle_t</a> <a class="code" href="group__aps__security.html#ga8e717dc80d8b9937b446523e0ec2a758" title="Get next key handle.">APS_NextKeys</a>(<span class="keyword">const</span> <a class="code" href="struct___a_p_s___key_handle__t.html">APS_KeyHandle_t</a> handle);
<a name="l00371"></a>00371 
<a name="l00372"></a>00372 <span class="comment">/**************************************************************************/</span>
<a name="l00381"></a>00381 <span class="keywordtype">void</span> <a class="code" href="aps_crypto_keys_8h.html#ab224a08c27f2baed2f1ecdde2ad3f6ac" title="(Un)authorize cryptographic key-pair of given device.">APS_SetAuthorizedStatus</a>(<span class="keyword">const</span> <a class="code" href="mac_addr_8h.html#a5b2913b1523fd1ce0a399c4fb047cc8b" title="Extended address type declaration.">ExtAddr_t</a> *<span class="keyword">const</span> deviceAddress,
<a name="l00382"></a>00382   <span class="keyword">const</span> <span class="keywordtype">bool</span> status);
<a name="l00383"></a>00383 
<a name="l00384"></a>00384 <span class="comment">/**************************************************************************/</span>
<a name="l00392"></a>00392 <span class="keywordtype">bool</span> <a class="code" href="aps_crypto_keys_8h.html#a428c802cd2c580de2558bc436e710063" title="Check authorization of crypthographic key-pair.">APS_AreKeysAuthorized</a>(<span class="keyword">const</span> <a class="code" href="mac_addr_8h.html#a5b2913b1523fd1ce0a399c4fb047cc8b" title="Extended address type declaration.">ExtAddr_t</a> *<span class="keyword">const</span> deviceAddress);
<a name="l00393"></a>00393 
<a name="l00394"></a>00394 <span class="comment">/**************************************************************************/</span>
<a name="l00405"></a>00405 <a class="code" href="struct___a_p_s___key_handle__t.html">APS_KeyHandle_t</a> <a class="code" href="aps_crypto_keys_8h.html#aa669d82a9bc4e74c4e294547ca1ea218" title="Reset device&#39;s keys and counters to default values.">APS_ResetKeys</a>(<span class="keyword">const</span> <a class="code" href="mac_addr_8h.html#a5b2913b1523fd1ce0a399c4fb047cc8b" title="Extended address type declaration.">ExtAddr_t</a> *<span class="keyword">const</span> deviceAddress,
<a name="l00406"></a>00406   <span class="keyword">const</span> <a class="code" href="aps_crypto_keys_8h.html#a5f81fc6b9c522838dcf58756fc77a000">APS_KeyResetFlags_t</a> flags);
<a name="l00407"></a>00407 
<a name="l00408"></a>00408 <span class="comment">/**************************************************************************/</span>
<a name="l00415"></a>00415 <span class="keywordtype">void</span> <a class="code" href="aps_crypto_keys_8h.html#a81471e3dcfbc1821c012abbd142cd3a1" title="Init APS key-pair set.">APS_InitKeyPairSet</a>(<span class="keywordtype">void</span>);
<a name="l00416"></a>00416 
<a name="l00417"></a>00417 <span class="comment">/**************************************************************************/</span>
<a name="l00421"></a>00421 <span class="keywordtype">void</span> <a class="code" href="aps_crypto_keys_8h.html#a0e6f3a19fb24a648ae4ba003f9e6cb2b" title="Reset APS key-pair set.">APS_ResetKeyPairSet</a>(<span class="keywordtype">void</span>);
<a name="l00422"></a>00422 
<a name="l00423"></a>00423 <span class="comment">/**************************************************************************/</span>
<a name="l00430"></a>00430 <a class="code" href="mac_addr_8h.html#a5b2913b1523fd1ce0a399c4fb047cc8b" title="Extended address type declaration.">ExtAddr_t</a>* <a class="code" href="aps_crypto_keys_8h.html#a101d632d3ef706940988e76777a7de95" title="Get extended device address of key-pair.">APS_GetKeyPairDeviceAddress</a>(<span class="keyword">const</span> <a class="code" href="struct___a_p_s___key_handle__t.html">APS_KeyHandle_t</a> handle);
<a name="l00431"></a>00431 
<a name="l00432"></a>00432 <span class="comment">/**************************************************************************/</span>
<a name="l00440"></a>00440 <span class="keywordtype">void</span> <a class="code" href="aps_crypto_keys_8h.html#a2e792ff64548986f95cdfa14447954b8" title="Find key-pair with old address and set new address.">APS_ChangeKeyPairDeviceAddress</a>(<span class="keyword">const</span> <a class="code" href="mac_addr_8h.html#a5b2913b1523fd1ce0a399c4fb047cc8b" title="Extended address type declaration.">ExtAddr_t</a> oldAddress,
<a name="l00441"></a>00441   <span class="keyword">const</span> <a class="code" href="mac_addr_8h.html#a5b2913b1523fd1ce0a399c4fb047cc8b" title="Extended address type declaration.">ExtAddr_t</a> newAddress);
<a name="l00442"></a>00442 
<a name="l00443"></a>00443 <span class="comment">/**************************************************************************/</span>
<a name="l00450"></a>00450 uint8_t* <a class="code" href="aps_crypto_keys_8h.html#a08a6c4e11264db8a074b63ba2b2e53ff" title="Get preinstalled link key.">APS_GetPreinstalledLinkKey</a>(<span class="keyword">const</span> <a class="code" href="struct___a_p_s___key_handle__t.html">APS_KeyHandle_t</a> handle);
<a name="l00451"></a>00451 
<a name="l00452"></a>00452 <span class="comment">/**************************************************************************/</span>
<a name="l00464"></a>00464 <a class="code" href="struct___a_p_s___key_handle__t.html">APS_KeyHandle_t</a> <a class="code" href="aps_crypto_keys_8h.html#a2acd200872994aaf646e20721738473f" title="Set new preinstalled link key for given device.">APS_SetPreinstalledLinkKey</a>(<span class="keyword">const</span> <a class="code" href="mac_addr_8h.html#a5b2913b1523fd1ce0a399c4fb047cc8b" title="Extended address type declaration.">ExtAddr_t</a> *<span class="keyword">const</span> deviceAddress,
<a name="l00465"></a>00465   <span class="keyword">const</span> uint8_t *<span class="keyword">const</span> preinstalledLinkKey);
<a name="l00466"></a>00466 
<a name="l00467"></a>00467 <span class="comment">/**************************************************************************/</span>
<a name="l00475"></a>00475 <span class="keywordtype">void</span> <a class="code" href="aps_crypto_keys_8h.html#a1c1ff4f6f19b91d90e0a61ce6baf04d4" title="Restores link key from preinstalled one. Uses to accept TC reestablishing keys with previously joined...">APS_RestorePreinstalledLinkKey</a>(<span class="keyword">const</span> <a class="code" href="mac_addr_8h.html#a5b2913b1523fd1ce0a399c4fb047cc8b" title="Extended address type declaration.">ExtAddr_t</a> *<span class="keyword">const</span> deviceAddress);
<a name="l00476"></a>00476 
<a name="l00477"></a>00477 <span class="comment">/**************************************************************************/</span>
<a name="l00484"></a>00484 <span class="keywordtype">void</span> <a class="code" href="aps_crypto_keys_8h.html#a30c1071a120dab6fee68f9f430faf52d" title="Stores link key to preinstalled one.">APS_StorePreinstalledLinkKey</a>(<span class="keyword">const</span> <a class="code" href="mac_addr_8h.html#a5b2913b1523fd1ce0a399c4fb047cc8b" title="Extended address type declaration.">ExtAddr_t</a> *<span class="keyword">const</span> deviceAddress);
<a name="l00485"></a>00485 
<a name="l00486"></a>00486 <span class="preprocessor">#ifdef _LINK_SECURITY_</span>
<a name="l00487"></a>00487 <span class="preprocessor"></span><span class="comment">/**************************************************************************/</span>
<a name="l00494"></a>00494 ApsOutFrameCounter_t <a class="code" href="aps_crypto_keys_8h.html#a49cf7504f1fb9ef8a182354104208971" title="Get current value of outgoing security frames counter.">APS_GetOutSecFrameCounter</a>(<span class="keyword">const</span> <a class="code" href="struct___a_p_s___key_handle__t.html">APS_KeyHandle_t</a> keyHandle);
<a name="l00495"></a>00495 
<a name="l00496"></a>00496 <span class="comment">/**************************************************************************/</span>
<a name="l00507"></a>00507 <a class="code" href="aps_common_8h.html#a1b4ff3a412400f1920d4d56e771230c8" title="APS status values.">APS_Status_t</a> <a class="code" href="aps_crypto_keys_8h.html#ab45513758c88c0f6067e04745d19c610" title="Set the new value of outgoing security frame counter for the device.">APS_SetOutSecFrameCounter</a>(<a class="code" href="mac_addr_8h.html#a5b2913b1523fd1ce0a399c4fb047cc8b" title="Extended address type declaration.">ExtAddr_t</a> deviceAddress, 
<a name="l00508"></a>00508   ApsOutFrameCounter_t counter);
<a name="l00509"></a>00509 
<a name="l00510"></a>00510 <span class="comment">/**************************************************************************/</span>
<a name="l00519"></a>00519 <span class="keywordtype">void</span> <a class="code" href="aps_crypto_keys_8h.html#afccf8848f22b5ca055b7633c45f9f6aa" title="Mark specified gloabal key as &#39;primary&#39;. It will used as default key for all transactions with unknow...">APS_MarkGlobalKeyAsPrimary</a>(<a class="code" href="struct___a_p_s___key_handle__t.html">APS_KeyHandle_t</a> handle);
<a name="l00520"></a>00520 
<a name="l00521"></a>00521 <span class="comment">/**************************************************************************/</span>
<a name="l00526"></a>00526 <span class="keywordtype">void</span> <a class="code" href="aps_crypto_keys_8h.html#af0f645068ec2288aa3e01b0613b45caa" title="Set the default trust center link key if the the key pair set is empty.">APS_SetDefaultTcLinkKey</a>(<span class="keywordtype">void</span>);
<a name="l00527"></a>00527 
<a name="l00528"></a>00528 <span class="comment">/**************************************************************************/</span>
<a name="l00533"></a>00533 <span class="keywordtype">void</span> <a class="code" href="aps_crypto_keys_8h.html#af44b09869c26529716575e2ba829fef0" title="Set the default distributed security link key if the the key pair set is empty.">APS_SetDefaultDsLinkKey</a>(<span class="keywordtype">void</span>);
<a name="l00534"></a>00534 
<a name="l00535"></a>00535 
<a name="l00536"></a>00536 <span class="comment">/**************************************************************************/</span>
<a name="l00544"></a>00544 <a class="code" href="struct___a_p_s___key_handle__t.html">APS_KeyHandle_t</a> <a class="code" href="aps_crypto_keys_8h.html#a3d3217899e73f50fa9bc30821d415953" title="Set extended address for global TC link key.">APS_UpdateGlobalTCKey</a>(<span class="keyword">const</span> <a class="code" href="mac_addr_8h.html#a5b2913b1523fd1ce0a399c4fb047cc8b" title="Extended address type declaration.">ExtAddr_t</a> *<span class="keyword">const</span> address);
<a name="l00545"></a>00545 
<a name="l00546"></a>00546 <span class="comment">/**************************************************************************/</span>
<a name="l00554"></a>00554 <span class="keywordtype">void</span> <a class="code" href="aps_crypto_keys_8h.html#a26f82062fde4415115f990ca69877851" title="Mark specified global key as &#39;TC key&#39;. It will be used for communication with TC.">APS_MarkGlobalKeyAsTCKey</a>(<a class="code" href="struct___a_p_s___key_handle__t.html">APS_KeyHandle_t</a> handle);
<a name="l00555"></a>00555 
<a name="l00556"></a>00556 <span class="comment">/**************************************************************************/</span>
<a name="l00563"></a>00563 <span class="keywordtype">void</span> <a class="code" href="aps_crypto_keys_8h.html#a97f99263953e0cf119bb87907828d5dd" title="Sets default key pair status.">APS_SetDefaultKeyPairStatus</a>(<a class="code" href="aps_crypto_keys_8h.html#a373f6961a6a46a46b8129f224fffe2ee">APS_KeyPairFlags_t</a> flag);
<a name="l00564"></a>00564 
<a name="l00565"></a>00565 <span class="comment">/**************************************************************************/</span>
<a name="l00573"></a>00573 <span class="keywordtype">void</span> <a class="code" href="aps_crypto_keys_8h.html#a3a5f54879bc65cef2f3fe66f59fd3a73" title="Take a backup of current link key and make the latest link key as operational. This will be used duri...">APS_UpdateLinkKey</a>(<span class="keyword">const</span> <a class="code" href="mac_addr_8h.html#a5b2913b1523fd1ce0a399c4fb047cc8b" title="Extended address type declaration.">ExtAddr_t</a> *<span class="keyword">const</span> deviceAddress);
<a name="l00574"></a>00574 
<a name="l00575"></a>00575 <span class="comment">/**************************************************************************/</span>
<a name="l00583"></a>00583 <span class="keywordtype">void</span> <a class="code" href="aps_crypto_keys_8h.html#a3a5f54879bc65cef2f3fe66f59fd3a73" title="Take a backup of current link key and make the latest link key as operational. This will be used duri...">APS_UpdateLinkKey</a>(<span class="keyword">const</span> <a class="code" href="mac_addr_8h.html#a5b2913b1523fd1ce0a399c4fb047cc8b" title="Extended address type declaration.">ExtAddr_t</a> *<span class="keyword">const</span> deviceAddress);
<a name="l00584"></a>00584 
<a name="l00585"></a>00585 <span class="comment">/**************************************************************************/</span>
<a name="l00592"></a>00592 <span class="keywordtype">bool</span> <a class="code" href="aps_crypto_keys_8h.html#ad38f5c2b17bc0a17d1c38f8516e5c3ab" title="Is the handle assocciated with a global or unique link key?">APS_IsGlobalLinkKey</a>(<span class="keyword">const</span> <a class="code" href="struct___a_p_s___key_handle__t.html">APS_KeyHandle_t</a> handle);
<a name="l00593"></a>00593 
<a name="l00594"></a>00594 <span class="comment">/**************************************************************************/</span>
<a name="l00601"></a>00601 <span class="keywordtype">bool</span> <a class="code" href="aps_crypto_keys_8h.html#a7c8abbdc20510ae31b05787a1074afb9" title="Is the handle assocciated with a updated TCLK or not?">APS_IsTclkUpdated</a>(<span class="keyword">const</span> <a class="code" href="struct___a_p_s___key_handle__t.html">APS_KeyHandle_t</a> handle);
<a name="l00602"></a>00602 
<a name="l00603"></a>00603 <span class="comment">/**************************************************************************/</span>
<a name="l00612"></a>00612 <a class="code" href="struct___a_p_s___key_handle__t.html">APS_KeyHandle_t</a> <a class="code" href="aps_crypto_keys_8h.html#a1354a2f8bfe0d435269f7c9f187737ea" title="Find initial (master key for High Security and preinstalled link key) or link key of device...">APS_IsIndividualKeyAvailable</a>(<span class="keyword">const</span> <a class="code" href="mac_addr_8h.html#a5b2913b1523fd1ce0a399c4fb047cc8b" title="Extended address type declaration.">ExtAddr_t</a> *<span class="keyword">const</span> deviceAddress);
<a name="l00613"></a>00613 
<a name="l00614"></a>00614 <span class="comment">/**************************************************************************/</span>
<a name="l00622"></a>00622 <span class="keywordtype">void</span> <a class="code" href="aps_crypto_keys_8h.html#a1088166859ce1ada03ce9850972ff2f0" title="Mark key pair set flags as requested. This won&#39;t reset any of the old flags.">APS_MarkKeyPairFlags</a>(<a class="code" href="struct___a_p_s___key_handle__t.html">APS_KeyHandle_t</a> handle, uint8_t flags);
<a name="l00623"></a>00623 
<a name="l00624"></a>00624 <span class="comment">/**************************************************************************/</span>
<a name="l00632"></a>00632 <span class="keywordtype">void</span> <a class="code" href="aps_crypto_keys_8h.html#aece9effd5d9f8dc9da04adb2ea15a397" title="Clear key pair set flags as requested.">APS_ClearKeyPairFlags</a>(<a class="code" href="struct___a_p_s___key_handle__t.html">APS_KeyHandle_t</a> handle, uint8_t flags);
<a name="l00633"></a>00633 
<a name="l00634"></a>00634 
<a name="l00635"></a>00635 <span class="preprocessor">#else</span>
<a name="l00636"></a>00636 <span class="preprocessor"></span><span class="preprocessor">#define APS_SetDefaultTcLinkKey() ((void)0)</span>
<a name="l00637"></a>00637 <span class="preprocessor"></span><span class="preprocessor">#define APS_SetDefaultDsLinkKey() ((void)0)</span>
<a name="l00638"></a>00638 <span class="preprocessor"></span><span class="preprocessor">#define APS_ResetKeyPairSet() ((void)0)</span>
<a name="l00639"></a>00639 <span class="preprocessor"></span><span class="preprocessor">#endif </span><span class="comment">/* _LINK_SECURITY_ */</span>
<a name="l00640"></a>00640 <span class="preprocessor">#endif </span><span class="comment">/* _APS_CRYPTO_KEYS_H */</span>
<a name="l00641"></a>00641 
</pre></div></div>
</div>
<hr style="border-top:1px solid #C4CFE5; margin-top:20px"/>
</body>
</html>
