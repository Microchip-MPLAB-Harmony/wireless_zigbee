<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>PIC32CX-BZ Zigbee API Reference: BitCloud Sample Applications</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PIC32CX-BZ Zigbee API Reference</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">BitCloud Sample Applications </div>  </div>
</div>
<div class="contents">
<div class="textblock"><p>Sample applications are provided with the BitCloud Software API in order to demonstrate how to develop user's applications. The BitCloud sample applications are intended to run on compatible platform devices.</p>
<h2><a class="anchor" id="system_requirements"></a>
System Requirements</h2>
<p>System requirements for a PC used to compile applications and program the nodes are: </p>
<table class="doxtable">
<tr>
<th colspan="2" align="left">PC </th></tr>
<tr>
<td>CPU</td><td>Intel Pentium III or higher, 800 MHz </td></tr>
<tr>
<td>RAM</td><td>128 MB </td></tr>
<tr>
<td>Hard disk free space</td><td>50 MB </td></tr>
<tr>
<th colspan="2" align="left">Software </th></tr>
<tr>
<td>Operating system</td><td>Windows2000/XP </td></tr>
<tr>
<td>USB driver </td><td>CP210x USB to UART Bridge VCP Driver </td></tr>
<tr>
<td>Java machine</td><td>Java Runtime Environment JRE 5.0 Update 8 (version 1.5.0) </td></tr>
</table>
<p>For detail on the toolchains available for your platform and instructions on how to program devices refer to <em>AVR2052 BitCloud Quick Start Guide</em>.</p>
<h2><a class="anchor" id="common_features"></a>
Common Features</h2>
<p>Each device must be configured with a unique short (network) address and the device type before a network start. Sample applications apply two different scenarios:</p>
<ul>
<li>Some applications use the static addressing scheme and therefore require the short address to be set at compile time in the <code>configuration.h</code> file. In this case each device requires a separetely compiled firmware image. </li>
<li>Other applications apply stochastic addessing and require the device type to be set at compile time in the <code>configuration.h</code> file. In this case each device type (coordinator, router, and (or) end device) requires a separetely compiled firmware image. The coordinator is assigned to the zero short address, while other devices receive random addresses. Note that some applications do not involve all device types.</li>
</ul>
<p>Most of sample applications make use of board periphery, typically, buttons and LEDs, through the Board Support Package (BSP) API. However, applications work correctly independently on whether the periphery involved is present on the board or not. If a board does not have buttons or LEDs, the API for these controls is still available although its functions do nothing, and therefore the same code as for platforms with real periphery is compiled and executed without errors on platforms without periphery.</p>
<p>Moreover, sample applications are designed in such a way that they do not require periphery. A network start is performed automatically on device startup, and applications generally fire timers to run features they are intended to demonstrate. At the same time LEDs indicate application activity, and buttons if present help to perform additional interaction with a demo application. For detail see descriptions of particular applications.</p>
<h2><a class="anchor" id="how_to_build"></a>
How to Build</h2>
<p>Source codes of all sample applications along with the corresponding configuration files are located at <code>[SDK]\Sample&#160;Applications\</code>. Hereafter, <code>[SDK]</code> denotes the root folder for the SDK installation.</p>
<p>The BitCloud library and Makerules files are contained at <code>[SDK]\BitCloud\lib\</code>. The choice of the particular library to include is made at compile time and based on the application's configuration parameters.</p>
<p>If makefiles are used to compile the application, in Makefile located in the application root folder select one of available projects and one of the configurations corresponding to this project. Thus you will point the build system, which low-level makefile from the <code>makefiles</code> directory shall be used. The name of a low-level makefile consists of parts that indicates the properties of this configuration. For example, if the name ends with <code>Gcc</code>, then the AVR GCC compiler will be used, while configurations with <code>Iar</code> will make use of the IAR compiler.</p>
<p>To compile an application from the command line, in the root application folder execute </p>
<div class="fragment"><pre class="fragment">make clean all
</pre></div><p>Alternatively you can open the <code>*.aps</code> file from the same directory with AVR Studio and then execute <em>Build\Rebuild&#160;All</em> in the <em>Project</em>menu. The <code>*.hex</code>, <code>*.srec</code>, <code>*.bin</code> and <code>*.elf</code>image files will be then generated.</p>
<p>Alternatively you can open the <code>.eww</code> file in the <code>iar_projects</code> subdirectory of the root application directory (for example for WSNDemo open WSNDemo.eww file from the <code>./Sample Applications/WSNDemo/iar_projects</code> subdirectory) with IAR Embedded Workbench and execute <em>Rebuild All</em> item from the Project menu after choosing an appropriate build configuration from the list of available configurations.</p>
<h2><a class="anchor" id="programming_boards"></a>
Programming the Boards</h2>
<p>The boards can be programmed using JTAG emulator, for example, JTAGICE mkII from Microchip, or with the help of other tools depending on the platform. For detail, refer to <em>AVR2052 BitCloud Quick Start Guide</em>.</p>
<h2><a class="anchor" id="connection"></a>
Connecting to a PC</h2>
<p>Most of the sample applications imply some interaction with a PC (although they may be run as well without connecting to a PC, when the only observation of the state and activities of the boards is performed by their LEDs). While WSNDemo uses a special custom PC application named <a href="App_zbn.html#WSN_Monitor">WSNMonitor</a>, other applications need just a general-purpose terminal application. The connection parameters must in a terminal window shall be set as follows (unless stated otherwise for a particular application): </p>
<table class="doxtable">
<tr>
<th>Parameter</th><th>Value </th></tr>
<tr>
<td>Data Rate</td><td>38400 bps </td></tr>
<tr>
<td>Data Bits</td><td>8 </td></tr>
<tr>
<td>Parity</td><td>None </td></tr>
<tr>
<td>Stop Bits</td><td>1 </td></tr>
<tr>
<td>Flow Control</td><td>None </td></tr>
</table>
<h2><a class="anchor" id="configparam"></a>
Configuration Parameters</h2>
<p>Application compile-time parameters are configured in the <code>configuration.h</code> file located in the target application's root directory. This file is used to define application-specific parameters usually prefixed with <code>APP_</code> and specify initial values for various ConfigServer parameters if different from the default values given in the <code><a class="el" href="cs_defaults_8h.html" title="Configuration Server parameters default values. The contents of this file must not be changed by a us...">csDefaults.h</a></code> file from the <code>include</code> directory of the ConfigServer component. It is not recommended to change the default values in <code><a class="el" href="cs_defaults_8h.html" title="Configuration Server parameters default values. The contents of this file must not be changed by a us...">csDefaults.h</a></code>, but rather specify required values in the application's <code>configuration.h</code> file.</p>
<h2><a class="anchor" id="channel_selection"></a>
Channel Selection</h2>
<p>To select a channel to work on, the user may change the channel mask definition (<a class="el" href="cs_defaults_8h.html#a2719d5610524a9c4fbb963422a3e861b" title="32-bit mask of channels to be scanned before network is started">CS_CHANNEL_MASK</a>) in the application's configuration file, recompile the application and program the nodes with a new image.</p>
<h2><a class="anchor" id="security"></a>
InstallCode</h2>
<p>By default, the NWK layer encryption (a standard security mechanism in the ZigBee specification) implemented in BitCloud stack is switched off. Different versions of compiled stack libraries are supplied for coordinator, router, end device, and all devices. Most of them are presented in two variants: "Security OFF", "Security ON", and "Standard Link Security ON". The choice of a particular library to include when compiling an application is defined by the configuration selected in the high-level Makefile or in IAR Embedded Workbench.</p>
<p>If security-enabled configuration is selected, consider <a class="el" href="cs_defaults_8h.html#a90c571c9ce64320c8418ad0ee9b71142" title="ZDO security status.">CS_ZDO_SECURITY_STATUS</a>, <a class="el" href="cs_defaults_8h.html#a9fde48eb1417ba3610f2a43c5fb7463e" title="Turns on/off security features.">CS_SECURITY_ON</a>, <a class="el" href="cs_defaults_8h.html#aa0ec974ff9561951b480bfefaa2b53f8" title="Default exteded address of the trust center.">CS_APS_TRUST_CENTER_ADDRESS</a>, and other security related parameters described on the <a href="cs_defaults_8h.html" class="el">CS parameters defaults</a> page.</p>
<p>Note that switching on the security option enlarges a firmware image, so that for some applications it may become too large to fit into the board's memory. In such case, the user may try to reduce it by decreasing <a class="el" href="cs_defaults_8h.html#ac177d516f6be1bacc13cdd5b87690e41" title="The size of the neighbor table.">CS_NEIB_TABLE_SIZE</a>, <a class="el" href="cs_defaults_8h.html#a2ab30b60c24b985b1f136557356db835" title="The maximum number of records in the NWK route table.">CS_ROUTE_TABLE_SIZE</a>, and other parameters that control memory allocation. </p>
</div></div>
<hr style="border-top:1px solid #C4CFE5; margin-top:20px"/>
</body>
</html>
