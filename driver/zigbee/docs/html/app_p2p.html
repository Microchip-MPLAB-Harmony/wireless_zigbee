<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>PIC32CX-BZ Zigbee API Reference: Peer-to-peer Application</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PIC32CX-BZ Zigbee API Reference</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">Peer-to-peer Application </div>  </div>
</div>
<div class="contents">
<div class="textblock"><p>This sample shows how to organize the simplest peer-to-peer link. A simple buffering strategy is employed to avoid byte-by-byte data transfer.</p>
<p>At least 2 nodes should be used: one coordinator and one router, but in total up to 8 nodes can be engaged. Nodes are identified by their short (network) addresses as assigned to the <a class="el" href="cs_defaults_8h.html#a2df225a416b19f639fb9b3bcf1ca8d8a" title="Device&#39;s short address if CS_NWK_UNIQUE_ADDR equals 1.">CS_NWK_ADDR</a> parameter in the <code>configuration.h</code> file. Thus firmware for each device shall be recompiled with a particular value of the <a class="el" href="cs_defaults_8h.html#a2df225a416b19f639fb9b3bcf1ca8d8a" title="Device&#39;s short address if CS_NWK_UNIQUE_ADDR equals 1.">CS_NWK_ADDR</a> parameter.</p>
<p>The network start procedure is initiated automatically on device startup.</p>
<p>In the network, wireless data exchange is performed strictly in pairs according to assigned short addresses:</p>
<ul>
<li>node 0 with node 1 </li>
<li>node 2 with node 3 </li>
<li>node 4 with node 5 </li>
<li>node 6 with node 7</li>
</ul>
<p>A node forwards all data received from the host over the serial interface (USART) to the corresponding peer. Upon a frame reception the peer node in its turn sends received data to own USART channel, thus a simple wireless USART link is established. For input/output of serial data on devices with USART/USB connection to a PC, Windows HyperTerminal can be used. When typing a message in one terminal window it is sent over the air to the peer node and should appear in the HyperTerminal instance associated with the peer device. COM port connection parameters should be configured on the PC in the following way: </p>
<table class="doxtable">
<tr>
<th>Parameter</th><th>Value </th></tr>
<tr>
<td>Data Rate</td><td>38400 baud </td></tr>
<tr>
<td>Data Bits</td><td>8 </td></tr>
<tr>
<td>Parity</td><td>None </td></tr>
<tr>
<td>Stop Bits</td><td>1 </td></tr>
<tr>
<td>Flow Control</td><td>Hardware </td></tr>
</table>
<p>In addition, if the board has buttons, pressing a certain button (<code>SW1</code> on a Meshbean board) on a node results in a transmission of a single maximum-length&lt; frame filled with <code>0xDD</code> bytes to the peer. This message appears on the peer node as a line of black rectangulars.</p>
<p>In order to use standard security mechanism described in ZigBee specification, the Peer2peer application shall be compiled with properly configured <a href="Sample_app.html#Security" class="el">security-related parameters</a>.</p>
<h2><a class="anchor" id="leds"></a>
LED Indications</h2>
<p>If LEDs are present on the board, then they are used by the application:</p>
<ul>
<li>The green LED is periodically blinking with 500ms interval when device is joining the network and is ON if it is in the network. </li>
<li>The red LED is flashing when the node is sending data. </li>
<li>The yellow LED is flashing when the node is receiving data.</li>
</ul>
<h2><a class="anchor" id="config_params"></a>
Configuration parameters</h2>
<table class="doxtable">
<tr>
<td><b>APP_FRAGMENTATION</b></td><td>Specifies whether or not frame fragmentation should be used inside the stack. </td></tr>
<tr>
<td><a class="el" href="cs_defaults_8h.html#a2df225a416b19f639fb9b3bcf1ca8d8a" title="Device&#39;s short address if CS_NWK_UNIQUE_ADDR equals 1.">CS_NWK_ADDR</a></td><td>Specifies the node's short address. Can be used only with CS_NWK_UNIQUE_ADDR set to <code>1</code>. </td></tr>
<tr>
<td><a class="el" href="cs_defaults_8h.html#a61ca65434a24b29c36a157f1e7fbf848" title="Determines whether the static or automatic addressing mode will be used for the short address...">CS_NWK_UNIQUE_ADDR</a></td><td>Specifies whether the short address is set to a predefined value or to a random value; is set to <code>1</code> by the application. </td></tr>
<tr>
<td><a class="el" href="cs_defaults_8h.html#af9a5ae0ebfa0d1b3edb25e8acb8738fc" title="End device sleep period given in milliseconds.">CS_END_DEVICE_SLEEP_PERIOD</a></td><td>The duration of the end device sleep period given in milliseconds. Should be the same on parent and children nodes. </td></tr>
<tr>
<td><a class="el" href="cs_defaults_8h.html#a2719d5610524a9c4fbb963422a3e861b" title="32-bit mask of channels to be scanned before network is started">CS_CHANNEL_MASK</a></td><td>Specifies a channel mask to be used for network operation. </td></tr>
<tr>
<td><a class="el" href="cs_defaults_8h.html#a04dae8e9e254f46b2d6275aa22a71bd1" title="Number of a channel page to be used. Ignored in the case of AT86RF230/230B/231 RF chip...">CS_CHANNEL_PAGE</a></td><td>Specifies a channel page to be used. </td></tr>
<tr>
<td><a class="el" href="cs_defaults_8h.html#ad913e01b52dd44a469260af694c6fd84" title="Extended PAN ID of the network to which the device should join.">CS_EXT_PANID</a></td><td>Specifies the network extended PANID. Should be unique at a given location. </td></tr>
<tr>
<td><a class="el" href="cs_defaults_8h.html#a330d543f324150e27474f40c950333c2" title="Custome Passive ack threshold.">CS_UID</a></td><td>The extended address for platforms where it is not available via the special UID chip or an external EEPROM. </td></tr>
</table>
<p>The description of parameters common for all applications can be found in <a href="Sample_app.html#ConfigParam" class="el">Sample Applications Overview</a>. ConfigServer parameters are described in the <a href="configserver.html" class="el">Configuration Server</a> section.</p>
<p>The source codes of the Peer-to-peer application is located in the <code>[SDK]\Sample&#160;Applications\Peer2peer</code> directory. </p>
</div></div>
<hr style="border-top:1px solid #C4CFE5; margin-top:20px"/>
</body>
</html>
